<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta http-equiv="Content-Type" name="viewport" content="width=device-width, initial-scale=1"/>
<title>一种画有向图的技术</title>
<link rel="stylesheet" href="https://leungwensen.github.io/zfinder/dist/lib/normalize-4.2.0.min.css">

  <link rel="stylesheet" href="https://leungwensen.github.io/zfinder/dist/lib/github-markdown-2.3.0.min.css">
  <link rel="stylesheet" href="https://leungwensen.github.io/zfinder/dist/lib/katex-0.7.1/katex.min.css">
  <link rel="stylesheet" href="https://leungwensen.github.io/zfinder/dist/zfinder/markdown-previewer.css">
</head>
<body>

<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"
     style="width:0;height:0;position:absolute;overflow:hidden;">
  <defs>
    <symbol id="si-zfinder-collapse-left" viewBox="0 0 38 38">
      <path d="M38 0H0v38h38V0zM3 35V3h32v32H3zM5 5v28h17V21h-9.667L16 26h-4l-5-7 5-7h4l-3.667 5H22V5H5z"/>
    </symbol>
    <symbol id="si-zfinder-expand-right" viewBox="0 0 38 38">
      <path d="M0 0h38v38H0V0zm35 35V3H3v32h32zM22 5v28H5V21h9.667L11 26h4l5-7-5-7h-4l3.667 5H5V5h17z"/>
    </symbol>
    <symbol id="si-zfinder-fullscreen" viewBox="0 0 28 28">
      <path d="M4 18H0v10h10v-4H4v-6zm-4-8h4V4h6V0H0v10zm24 14h-6v4h10V18h-4v6zM18 0v4h6v6h4V0H18z"/>
    </symbol>
    <symbol id="si-zfinder-fullscreen-exit" viewBox="0 0 28 28">
      <path d="M0 22h6v6h4V18H0v4zM6 6H0v4h10V0H6v6zm12 22h4v-6h6v-4H18v10zm4-22V0h-4v10h10V6h-6z"/>
    </symbol>
  </defs>
</svg>
<nav id="toc">
  <div id="toc-body" class="toc-body"></div>
</nav>
<article id="markdown">
  <nav id="markdown-header" class="markdown-header">
    <svg class="si" id="toggle-toc" width="24" height="24">
      <use xlink:href="#si-zfinder-collapse-left"></use>
    </svg>
    <svg class="si float-right" id="toggle-fullscreen-article" width="24" height="24">
      <use xlink:href="#si-zfinder-fullscreen"></use>
    </svg>
  </nav>
  <div id="markdown-body" class="markdown-body"><h1>一种画有向图的技术</h1>
<h2>原文信息</h2>
<p>原文是AT&amp;T贝尔实验室graphviz项目组沉淀的一篇论文，描述了graphviz中的dot布局所用的算法。</p>
<h3>作者信息</h3>
<pre><code>Emden R. Gansner
Eleftherios Koutsofios
Stephen C. North
Kiem-Phong Vo

AT&amp;T Bell Laboratories Murray Hill, New Jersey 07974
</code></pre>
<h2>术语表（按字母顺序排序）</h2>
<table>
<thead>
<tr>
<th>英文</th>
<th>中文</th>
</tr>
</thead>
<tbody>
<tr>
<td>B-spline</td>
<td>B样条</td>
</tr>
<tr>
<td>backward edge</td>
<td>后向边</td>
</tr>
<tr>
<td>component</td>
<td>组件</td>
</tr>
<tr>
<td>cross edge</td>
<td>交叉边</td>
</tr>
<tr>
<td>cut value</td>
<td>切值</td>
</tr>
<tr>
<td>depth-first search</td>
<td>深度优先搜索</td>
</tr>
<tr>
<td>edge</td>
<td>边</td>
</tr>
<tr>
<td>forward edge</td>
<td>前向边</td>
</tr>
<tr>
<td>node</td>
<td>节点</td>
</tr>
<tr>
<td>non-tree edge</td>
<td>非树形边</td>
</tr>
<tr>
<td>rank</td>
<td>层级</td>
</tr>
<tr>
<td>ranking</td>
<td>排序</td>
</tr>
<tr>
<td>self-edge</td>
<td>自连边</td>
</tr>
<tr>
<td>multi-edges</td>
<td>重复边</td>
</tr>
<tr>
<td>slack</td>
<td>松弛度</td>
</tr>
<tr>
<td>spline</td>
<td>样条</td>
</tr>
<tr>
<td>tree edge</td>
<td>树形边</td>
</tr>
<tr>
<td>vertex</td>
<td>顶点</td>
</tr>
<tr>
<td>head component</td>
<td>头分量</td>
</tr>
<tr>
<td>tail component</td>
<td>尾分量</td>
</tr>
</tbody>
</table>
<h3>相关链接</h3>
<ul>
<li><a href="http://www.graphviz.org/Documentation/TSE93.pdf">原文</a></li>
<li><a href="http://www.graphviz.org/">graphviz</a></li>
<li><a href="http://www.graphviz.org/pdf/dotguide.pdf">dot language</a></li>
</ul>
<h2>摘要</h2>
<p>本文描述了一种四步画有向图的算法。第一步用网络单纯形算法找出最优的节点层级分配。第二步用结合了新型加权函数和局部置换的迭代启发式算法为同一层级的顶点确定次序，以减少交叉。第三步通过构建和排序辅助图的方式确定最优的节点坐标。第四步通过计算样条来画边。这个算法能快速画出美观的有向图。</p>
<h2>1. 引言</h2>
<p>画抽象图是一个活跃的研究领域，其应用范围包括程序和数据结构可视化，以及文档准备等。本文描述了一种平面上画有向图的技术。目标是能找到快速画高质量图的方法，以供实时交互使用。这些算法是一个实际应用<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup> 的基石。</p>
<h3>1.1 美学标准</h3>
<p>如果假设有向图有一个总体的流向或者方向，那么画图时会简单很多。譬如自顶向下（像本文大部分例子一样），或者从左往右。手绘的从起始状态到终止状态的有限状态机或者从输入到输出的数据流图中这样的流向很常见。这样的结论催生了基于以下美学准则的一系列有向图绘图方法。</p>
<ul>
<li>A1. 在图中展示层次结构。并且尽可能让所有的边指向同一个方向。这样有助于找出有向路径和定位起始和终止节点。</li>
<li>A2. 避免和图无关的视觉异常。譬如要避免边的交叉和急转。</li>
<li>A3. 尽量用短边。这样有助于定位关联节点和A2。</li>
<li>A4. 倾向于对称和平衡。此标准在本文算法的某些环节中是次要的。</li>
</ul>
<p>兼顾所有这些标准是不可能的。举个例子，A1决定的节点布局和边的方向也许会造成边交叉，从而违反了A2。并且，要最小化边交叉或者布局出对称的子图，会导致巨量的计算。所以本文作了一些简化的假设，并且依赖启发式算法以达到在普遍的情况下能快速得到一个美观的布局。读者如果需要进一步了解其他美学准则，可以参考Eades和Tamassia的注释书目中的画图算法<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup>。</p>
<h3>1.2 问题描述</h3>
<p>画图算法的输入是一个可能包含环和多边的属性图<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi><mo>=</mo><mo>(</mo><mi>V</mi><mo separator="true">,</mo><mi>E</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">G=(V,E)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mclose">)</span></span></span></span>。假设<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span></span></span></span>已连接，并且每个连接的组件可以单独列举。其属性如下。</p>
<table>
<thead>
<tr>
<th>表达式</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>(</mo><mi>v</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">xsize(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mord mathit">e</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>(</mo><mi>v</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">ysize(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mord mathit">e</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span></td>
<td>节点v边界框的大小</td>
</tr>
<tr>
<td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>s</mi><mi>e</mi><mi>p</mi><mo>(</mo><mi>G</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">nodesep(G)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span><span class="mord mathit">o</span><span class="mord mathit">d</span><span class="mord mathit">e</span><span class="mord mathit">s</span><span class="mord mathit">e</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">G</span><span class="mclose">)</span></span></span></span></td>
<td>节点边界框之间最小水平间隔</td>
</tr>
<tr>
<td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mi>a</mi><mi>n</mi><mi>k</mi><mi>s</mi><mi>e</mi><mi>p</mi><mo>(</mo><mi>G</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">ranksep(G)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">n</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mord mathit">s</span><span class="mord mathit">e</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">G</span><span class="mclose">)</span></span></span></span></td>
<td>节点边界框之间最小竖直间隔</td>
</tr>
<tr>
<td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi><mo>(</mo><mi>e</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">w(e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mclose">)</span></span></span></span></td>
<td>边e的权重，通常是1。权重代表边的重要程度，权重大的边在图中会更短并且竖直方向对齐</td>
</tr>
</tbody>
</table>
<p>算法会在平面上为每个节点v分配一个矩形的中心点<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>x</mi><mo>(</mo><mi>v</mi><mo>)</mo><mo separator="true">,</mo><mi>y</mi><mo>(</mo><mi>v</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">(x(v),y(v))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">x</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>，并给每条边生成一条B样条的控制点序列<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>(</mo><mi>e</mi><mo>)</mo><mo separator="true">,</mo><msub><mi>y</mi><mn>0</mn></msub><mo>(</mo><mi>e</mi><mo>)</mo><mo>)</mo><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mo>(</mo><msub><mi>x</mi><mi>n</mi></msub><mo>(</mo><mi>e</mi><mo>)</mo><mo separator="true">,</mo><msub><mi>y</mi><mi>n</mi></msub><mo>(</mo><mi>e</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">(x_0(e),y_0(e)),...,(x_n(e),y_n(e))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mclose">)</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mpunct">,</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>。这些值都没有指定单位，根据经验，用72单位／英寸的坐标系统有助于实现。实际布局会遵循美学标准A1-A4以及图本身的属性。随后的章节会展示这些条件限制的细节。</p>
<p>算法还提供了画带活动表的图或者高亮起始终止节点的方法，用户可以据此进一步定制布局。下一章节描述的初始化步骤会把各个节点分配到互相独立的层级上（<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>0</mn><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi>M</mi><mi>a</mi><mi>x</mi><mi mathvariant="normal">_</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">0...Max\_rank</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:1.00444em;vertical-align:-0.31em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">n</span><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span>）。同一层级上的节点的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.22222em;">Y</span></span></span></span>坐标相等。用户还可以指定顶点集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.22222em;">V</span></span></span></span>的子集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo separator="true">,</mo><msub><mi>S</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><msub><mi>S</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>S</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>S</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">S_{max},S_{min},S_0,S_1,...,S_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>。这些（可能是空集的）顶点集将会被各自强制分配到最大层级，最小层级或者某个统一层级上。</p>
<h3>1.3 相关工作</h3>
<p>Warfield<sup class="footnote-ref"><a href="#fn3" id="fnref3">[3]</a></sup>最先提出使用启发式算法画有向图以减少边交叉，Carpano<sup class="footnote-ref"><a href="#fn4" id="fnref4">[4]</a></sup>和Sugiyama，Tagawa以及Toda等人<sup class="footnote-ref"><a href="#fn5" id="fnref5">[5]</a></sup>也发现了类似的方法。Di Battista和Tamassia提出了一种所有边指向同一方向的平面布局有向图的算法<sup class="footnote-ref"><a href="#fn6" id="fnref6">[6]</a></sup>。本文算法是基于Warfield，Sugiyama等人工作之上的。</p>
<h3>1.4 概述</h3>
<p>如图1-1所示，本画图算法分四步。第一步把节点分配到各个独立层级上。第二步为每一层的节点排序，以减少边交叉。第三步确定节点的实际布局坐标。最后一步确定每条边的B样条控制点。</p>
<blockquote>
<p>图1-1. 主算法</p>
</blockquote>
<pre><code>procedure draw_graph()
begin
    rank();
    ordering();
    position();
    make_splines();
end
</code></pre>
<p>本文的贡献在于</p>
<ol>
<li>使用网络单纯形算法高效地为节点指定层级</li>
<li>使用一种优化的启发式算法减少边交叉</li>
<li>为层级分配问题使用一种节点坐标计算方法</li>
<li>一种指定样条控制点的方法</li>
</ol>
<p>1和2种的方法最先在画图软件dag中实现<sup class="footnote-ref"><a href="#fn1" id="fnref1:1">[1:1]</a></sup>。进一步的工作，尤其是3和4被纳入dag的替代品dot<sup class="footnote-ref"><a href="#fn7" id="fnref7">[7]</a></sup>中。图1-2和1-3是dot的布局示例及其输入文件。</p>
<blockquote>
<p>图1-2a. (Sun-4/28机器上渲染用时1.11秒)</p>
</blockquote>
<div class="viz-graph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: world_dynamics Pages: 1 -->
<svg width="432pt" height="220pt"
 viewBox="0.00 0.00 432.00 220.08" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(.355 .355) rotate(0) translate(4 616)">
<title>world_dynamics</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-616 1213,-616 1213,4 -4,4"/>
<!-- S8 -->
<g id="node1" class="node">
<title>S8</title>
<ellipse fill="none" stroke="#000000" cx="227" cy="-522" rx="27" ry="18"/>
<text text-anchor="middle" x="227" y="-517.8" font-family="Times,serif" font-size="14.00" fill="#000000">S8</text>
</g>
<!-- 9 -->
<g id="node2" class="node">
<title>9</title>
<ellipse fill="none" stroke="#000000" cx="227" cy="-450" rx="27" ry="18"/>
<text text-anchor="middle" x="227" y="-445.8" font-family="Times,serif" font-size="14.00" fill="#000000">9</text>
</g>
<!-- S8&#45;&gt;9 -->
<g id="edge1" class="edge">
<title>S8&#45;&gt;9</title>
<path fill="none" stroke="#000000" d="M227,-503.8314C227,-496.131 227,-486.9743 227,-478.4166"/>
<polygon fill="#000000" stroke="#000000" points="230.5001,-478.4132 227,-468.4133 223.5001,-478.4133 230.5001,-478.4132"/>
</g>
<!-- 42 -->
<g id="node15" class="node">
<title>42</title>
<ellipse fill="none" stroke="#000000" cx="302" cy="-378" rx="27" ry="18"/>
<text text-anchor="middle" x="302" y="-373.8" font-family="Times,serif" font-size="14.00" fill="#000000">42</text>
</g>
<!-- 9&#45;&gt;42 -->
<g id="edge10" class="edge">
<title>9&#45;&gt;42</title>
<path fill="none" stroke="#000000" d="M242.54,-435.0816C253.099,-424.945 267.2444,-411.3654 279.0892,-399.9944"/>
<polygon fill="#000000" stroke="#000000" points="281.6898,-402.3495 286.4799,-392.8993 276.8421,-397.2998 281.6898,-402.3495"/>
</g>
<!-- T1 -->
<g id="node16" class="node">
<title>T1</title>
<ellipse fill="none" stroke="#000000" cx="597" cy="-90" rx="27" ry="18"/>
<text text-anchor="middle" x="597" y="-85.8" font-family="Times,serif" font-size="14.00" fill="#000000">T1</text>
</g>
<!-- 9&#45;&gt;T1 -->
<g id="edge11" class="edge">
<title>9&#45;&gt;T1</title>
<path fill="none" stroke="#000000" d="M213.464,-434.2284C199.4486,-415.8677 181.2534,-384.8843 194,-360 234.2454,-281.4317 478.8337,-150.4783 566.0986,-105.6263"/>
<polygon fill="#000000" stroke="#000000" points="567.9232,-108.6243 575.2303,-100.9524 564.7338,-102.393 567.9232,-108.6243"/>
</g>
<!-- S24 -->
<g id="node3" class="node">
<title>S24</title>
<ellipse fill="none" stroke="#000000" cx="109" cy="-522" rx="27" ry="18"/>
<text text-anchor="middle" x="109" y="-517.8" font-family="Times,serif" font-size="14.00" fill="#000000">S24</text>
</g>
<!-- 27 -->
<g id="node4" class="node">
<title>27</title>
<ellipse fill="none" stroke="#000000" cx="55" cy="-378" rx="27" ry="18"/>
<text text-anchor="middle" x="55" y="-373.8" font-family="Times,serif" font-size="14.00" fill="#000000">27</text>
</g>
<!-- S24&#45;&gt;27 -->
<g id="edge2" class="edge">
<title>S24&#45;&gt;27</title>
<path fill="none" stroke="#000000" d="M102.3785,-504.3428C93.1076,-479.6202 76.1728,-434.4608 65.2615,-405.3639"/>
<polygon fill="#000000" stroke="#000000" points="68.4641,-403.936 61.6756,-395.8017 61.9098,-406.3939 68.4641,-403.936"/>
</g>
<!-- 25 -->
<g id="node5" class="node">
<title>25</title>
<ellipse fill="none" stroke="#000000" cx="137" cy="-450" rx="27" ry="18"/>
<text text-anchor="middle" x="137" y="-445.8" font-family="Times,serif" font-size="14.00" fill="#000000">25</text>
</g>
<!-- S24&#45;&gt;25 -->
<g id="edge3" class="edge">
<title>S24&#45;&gt;25</title>
<path fill="none" stroke="#000000" d="M115.778,-504.5708C118.9872,-496.3187 122.8935,-486.2738 126.4758,-477.0623"/>
<polygon fill="#000000" stroke="#000000" points="129.8248,-478.1069 130.1874,-467.5182 123.3008,-475.5697 129.8248,-478.1069"/>
</g>
<!-- T24 -->
<g id="node18" class="node">
<title>T24</title>
<ellipse fill="none" stroke="#000000" cx="27" cy="-90" rx="27" ry="18"/>
<text text-anchor="middle" x="27" y="-85.8" font-family="Times,serif" font-size="14.00" fill="#000000">T24</text>
</g>
<!-- 27&#45;&gt;T24 -->
<g id="edge14" class="edge">
<title>27&#45;&gt;T24</title>
<path fill="none" stroke="#000000" d="M53.2485,-359.9843C48.5147,-311.2939 35.4385,-176.7961 29.7278,-118.0573"/>
<polygon fill="#000000" stroke="#000000" points="33.2022,-117.6232 28.7509,-108.0089 26.235,-118.3007 33.2022,-117.6232"/>
</g>
<!-- 25&#45;&gt;T1 -->
<g id="edge12" class="edge">
<title>25&#45;&gt;T1</title>
<path fill="none" stroke="#000000" d="M137,-431.8146C137,-404.4983 137,-351.25 137,-306 137,-306 137,-306 137,-234 137,-193.1184 125.8734,-171.6351 156,-144 185.6112,-116.8376 459.1989,-98.1165 559.9665,-92.0911"/>
<polygon fill="#000000" stroke="#000000" points="560.2205,-95.5823 569.9969,-91.4992 559.8081,-88.5944 560.2205,-95.5823"/>
</g>
<!-- 26 -->
<g id="node17" class="node">
<title>26</title>
<ellipse fill="none" stroke="#000000" cx="230" cy="-378" rx="27" ry="18"/>
<text text-anchor="middle" x="230" y="-373.8" font-family="Times,serif" font-size="14.00" fill="#000000">26</text>
</g>
<!-- 25&#45;&gt;26 -->
<g id="edge13" class="edge">
<title>25&#45;&gt;26</title>
<path fill="none" stroke="#000000" d="M154.9313,-436.1177C168.8264,-425.3602 188.2781,-410.3009 203.8991,-398.2072"/>
<polygon fill="#000000" stroke="#000000" points="206.3591,-400.729 212.1237,-391.8397 202.0738,-395.1939 206.3591,-400.729"/>
</g>
<!-- S1 -->
<g id="node6" class="node">
<title>S1</title>
<ellipse fill="none" stroke="#000000" cx="822" cy="-594" rx="27" ry="18"/>
<text text-anchor="middle" x="822" y="-589.8" font-family="Times,serif" font-size="14.00" fill="#000000">S1</text>
</g>
<!-- 10 -->
<g id="node7" class="node">
<title>10</title>
<ellipse fill="none" stroke="#000000" cx="858" cy="-522" rx="27" ry="18"/>
<text text-anchor="middle" x="858" y="-517.8" font-family="Times,serif" font-size="14.00" fill="#000000">10</text>
</g>
<!-- S1&#45;&gt;10 -->
<g id="edge4" class="edge">
<title>S1&#45;&gt;10</title>
<path fill="none" stroke="#000000" d="M830.7146,-576.5708C834.9597,-568.0807 840.1536,-557.6929 844.8663,-548.2674"/>
<polygon fill="#000000" stroke="#000000" points="848.024,-549.7782 849.3657,-539.2687 841.763,-546.6477 848.024,-549.7782"/>
</g>
<!-- 2 -->
<g id="node8" class="node">
<title>2</title>
<ellipse fill="none" stroke="#000000" cx="786" cy="-522" rx="27" ry="18"/>
<text text-anchor="middle" x="786" y="-517.8" font-family="Times,serif" font-size="14.00" fill="#000000">2</text>
</g>
<!-- S1&#45;&gt;2 -->
<g id="edge5" class="edge">
<title>S1&#45;&gt;2</title>
<path fill="none" stroke="#000000" d="M813.2854,-576.5708C809.0403,-568.0807 803.8464,-557.6929 799.1337,-548.2674"/>
<polygon fill="#000000" stroke="#000000" points="802.237,-546.6477 794.6343,-539.2687 795.976,-549.7782 802.237,-546.6477"/>
</g>
<!-- 10&#45;&gt;T1 -->
<g id="edge22" class="edge">
<title>10&#45;&gt;T1</title>
<path fill="none" stroke="#000000" d="M884.4701,-518.2835C941.4861,-509.9799 1073.9776,-488.9958 1114,-468 1165.5042,-440.9809 1209,-436.1611 1209,-378 1209,-378 1209,-378 1209,-234 1209,-115.2393 766.8018,-94.3316 634.1663,-90.7316"/>
<polygon fill="#000000" stroke="#000000" points="634.1722,-87.2307 624.0865,-90.4756 633.9944,-94.2284 634.1722,-87.2307"/>
</g>
<!-- 11 -->
<g id="node23" class="node">
<title>11</title>
<ellipse fill="none" stroke="#000000" cx="484" cy="-378" rx="27" ry="18"/>
<text text-anchor="middle" x="484" y="-373.8" font-family="Times,serif" font-size="14.00" fill="#000000">11</text>
</g>
<!-- 10&#45;&gt;11 -->
<g id="edge20" class="edge">
<title>10&#45;&gt;11</title>
<path fill="none" stroke="#000000" d="M836.5371,-510.6232C831.8084,-508.2991 826.7827,-505.9658 822,-504 774.4216,-484.4445 756.1914,-494.3296 712,-468 692.014,-456.0922 694.2165,-443.512 674,-432 660.4787,-424.3005 570.6287,-400.376 519.4757,-387.1026"/>
<polygon fill="#000000" stroke="#000000" points="520.0499,-383.636 509.492,-384.5197 518.2966,-390.4129 520.0499,-383.636"/>
</g>
<!-- 14 -->
<g id="node24" class="node">
<title>14</title>
<ellipse fill="none" stroke="#000000" cx="774" cy="-378" rx="27" ry="18"/>
<text text-anchor="middle" x="774" y="-373.8" font-family="Times,serif" font-size="14.00" fill="#000000">14</text>
</g>
<!-- 10&#45;&gt;14 -->
<g id="edge21" class="edge">
<title>10&#45;&gt;14</title>
<path fill="none" stroke="#000000" d="M851.4901,-504.4437C844.2498,-485.8228 831.6278,-455.86 817,-432 810.5738,-421.518 802.3923,-410.7647 794.8944,-401.6411"/>
<polygon fill="#000000" stroke="#000000" points="797.3891,-399.1699 788.2707,-393.7749 792.0345,-403.6787 797.3891,-399.1699"/>
</g>
<!-- 13 -->
<g id="node25" class="node">
<title>13</title>
<ellipse fill="none" stroke="#000000" cx="748" cy="-450" rx="27" ry="18"/>
<text text-anchor="middle" x="748" y="-445.8" font-family="Times,serif" font-size="14.00" fill="#000000">13</text>
</g>
<!-- 10&#45;&gt;13 -->
<g id="edge23" class="edge">
<title>10&#45;&gt;13</title>
<path fill="none" stroke="#000000" d="M838.5874,-509.2936C821.258,-497.9507 795.6682,-481.201 776.1028,-468.3946"/>
<polygon fill="#000000" stroke="#000000" points="777.8724,-465.3698 767.5885,-462.8216 774.0387,-471.2267 777.8724,-465.3698"/>
</g>
<!-- 12 -->
<g id="node26" class="node">
<title>12</title>
<ellipse fill="none" stroke="#000000" cx="1143" cy="-378" rx="27" ry="18"/>
<text text-anchor="middle" x="1143" y="-373.8" font-family="Times,serif" font-size="14.00" fill="#000000">12</text>
</g>
<!-- 10&#45;&gt;12 -->
<g id="edge24" class="edge">
<title>10&#45;&gt;12</title>
<path fill="none" stroke="#000000" d="M884.6266,-518.2107C937.338,-510.3054 1052.6789,-490.8768 1085,-468 1107.0357,-452.4031 1122.7363,-425.5363 1132.1976,-405.2068"/>
<polygon fill="#000000" stroke="#000000" points="1135.5005,-406.3915 1136.3414,-395.83 1129.0979,-403.5619 1135.5005,-406.3915"/>
</g>
<!-- 2&#45;&gt;T1 -->
<g id="edge18" class="edge">
<title>2&#45;&gt;T1</title>
<path fill="none" stroke="#000000" d="M803.0576,-508.0044C829.9059,-484.2886 879,-433.3545 879,-378 879,-378 879,-378 879,-234 879,-125.3198 710.8148,-98.6188 634.2133,-92.0938"/>
<polygon fill="#000000" stroke="#000000" points="634.2812,-88.5885 624.0393,-91.3006 633.737,-95.5674 634.2812,-88.5885"/>
</g>
<!-- 3 -->
<g id="node19" class="node">
<title>3</title>
<ellipse fill="none" stroke="#000000" cx="412" cy="-378" rx="27" ry="18"/>
<text text-anchor="middle" x="412" y="-373.8" font-family="Times,serif" font-size="14.00" fill="#000000">3</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge15" class="edge">
<title>2&#45;&gt;3</title>
<path fill="none" stroke="#000000" d="M760.6022,-515.8512C724.735,-506.8751 657.4313,-488.9532 602,-468 531.3251,-441.2847 516.0176,-428.8976 448,-396 446.2544,-395.1557 444.4642,-394.2829 442.6596,-393.3978"/>
<polygon fill="#000000" stroke="#000000" points="444.1716,-390.241 433.6565,-388.9436 441.0674,-396.5151 444.1716,-390.241"/>
</g>
<!-- 16 -->
<g id="node20" class="node">
<title>16</title>
<ellipse fill="none" stroke="#000000" cx="642" cy="-306" rx="27" ry="18"/>
<text text-anchor="middle" x="642" y="-301.8" font-family="Times,serif" font-size="14.00" fill="#000000">16</text>
</g>
<!-- 2&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>2&#45;&gt;16</title>
<path fill="none" stroke="#000000" d="M789.9181,-504.0145C793.1022,-485.0352 795.4118,-454.776 784,-432 772.3704,-408.7895 757.7116,-412.8947 738,-396 712.0826,-373.7863 683.7165,-346.8445 664.5887,-328.2607"/>
<polygon fill="#000000" stroke="#000000" points="666.841,-325.5682 657.2393,-321.0895 661.9524,-330.5784 666.841,-325.5682"/>
</g>
<!-- 17 -->
<g id="node21" class="node">
<title>17</title>
<ellipse fill="none" stroke="#000000" cx="638" cy="-450" rx="27" ry="18"/>
<text text-anchor="middle" x="638" y="-445.8" font-family="Times,serif" font-size="14.00" fill="#000000">17</text>
</g>
<!-- 2&#45;&gt;17 -->
<g id="edge17" class="edge">
<title>2&#45;&gt;17</title>
<path fill="none" stroke="#000000" d="M764.1621,-511.3762C739.0222,-499.1459 697.5399,-478.9654 669.0492,-465.105"/>
<polygon fill="#000000" stroke="#000000" points="670.451,-461.8948 659.9275,-460.6674 667.3887,-468.1895 670.451,-461.8948"/>
</g>
<!-- 18 -->
<g id="node22" class="node">
<title>18</title>
<ellipse fill="none" stroke="#000000" cx="1116" cy="-306" rx="27" ry="18"/>
<text text-anchor="middle" x="1116" y="-301.8" font-family="Times,serif" font-size="14.00" fill="#000000">18</text>
</g>
<!-- 2&#45;&gt;18 -->
<g id="edge19" class="edge">
<title>2&#45;&gt;18</title>
<path fill="none" stroke="#000000" d="M806.9222,-510.394C811.7699,-508.0295 816.9815,-505.7373 822,-504 897.0374,-478.0237 930.1504,-510.8546 997,-468 1049.32,-434.4598 1086.4346,-369.1879 1104.18,-332.5634"/>
<polygon fill="#000000" stroke="#000000" points="1107.3667,-334.0116 1108.4703,-323.4744 1101.0365,-331.0235 1107.3667,-334.0116"/>
</g>
<!-- S35 -->
<g id="node9" class="node">
<title>S35</title>
<ellipse fill="none" stroke="#000000" cx="457" cy="-594" rx="27" ry="18"/>
<text text-anchor="middle" x="457" y="-589.8" font-family="Times,serif" font-size="14.00" fill="#000000">S35</text>
</g>
<!-- 36 -->
<g id="node10" class="node">
<title>36</title>
<ellipse fill="none" stroke="#000000" cx="534" cy="-522" rx="27" ry="18"/>
<text text-anchor="middle" x="534" y="-517.8" font-family="Times,serif" font-size="14.00" fill="#000000">36</text>
</g>
<!-- S35&#45;&gt;36 -->
<g id="edge6" class="edge">
<title>S35&#45;&gt;36</title>
<path fill="none" stroke="#000000" d="M472.9544,-579.0816C483.795,-568.945 498.3176,-555.3654 510.4782,-543.9944"/>
<polygon fill="#000000" stroke="#000000" points="513.1522,-546.2858 518.066,-536.8993 508.3712,-541.1728 513.1522,-546.2858"/>
</g>
<!-- 43 -->
<g id="node11" class="node">
<title>43</title>
<ellipse fill="none" stroke="#000000" cx="380" cy="-522" rx="27" ry="18"/>
<text text-anchor="middle" x="380" y="-517.8" font-family="Times,serif" font-size="14.00" fill="#000000">43</text>
</g>
<!-- S35&#45;&gt;43 -->
<g id="edge7" class="edge">
<title>S35&#45;&gt;43</title>
<path fill="none" stroke="#000000" d="M441.0456,-579.0816C430.205,-568.945 415.6824,-555.3654 403.5218,-543.9944"/>
<polygon fill="#000000" stroke="#000000" points="405.6288,-541.1728 395.934,-536.8993 400.8478,-546.2858 405.6288,-541.1728"/>
</g>
<!-- 19 -->
<g id="node32" class="node">
<title>19</title>
<ellipse fill="none" stroke="#000000" cx="594" cy="-378" rx="27" ry="18"/>
<text text-anchor="middle" x="594" y="-373.8" font-family="Times,serif" font-size="14.00" fill="#000000">19</text>
</g>
<!-- 36&#45;&gt;19 -->
<g id="edge45" class="edge">
<title>36&#45;&gt;19</title>
<path fill="none" stroke="#000000" d="M541.2374,-504.6302C551.5534,-479.8719 570.5806,-434.2064 582.7457,-405.0103"/>
<polygon fill="#000000" stroke="#000000" points="586.1215,-406.0083 586.7369,-395.4314 579.6599,-403.316 586.1215,-406.0083"/>
</g>
<!-- 38 -->
<g id="node37" class="node">
<title>38</title>
<ellipse fill="none" stroke="#000000" cx="308" cy="-450" rx="27" ry="18"/>
<text text-anchor="middle" x="308" y="-445.8" font-family="Times,serif" font-size="14.00" fill="#000000">38</text>
</g>
<!-- 43&#45;&gt;38 -->
<g id="edge43" class="edge">
<title>43&#45;&gt;38</title>
<path fill="none" stroke="#000000" d="M364.7307,-506.7307C354.803,-496.803 341.6847,-483.6847 330.5637,-472.5637"/>
<polygon fill="#000000" stroke="#000000" points="332.7933,-469.8436 323.2473,-465.2473 327.8436,-474.7933 332.7933,-469.8436"/>
</g>
<!-- 40 -->
<g id="node38" class="node">
<title>40</title>
<ellipse fill="none" stroke="#000000" cx="452" cy="-450" rx="27" ry="18"/>
<text text-anchor="middle" x="452" y="-445.8" font-family="Times,serif" font-size="14.00" fill="#000000">40</text>
</g>
<!-- 43&#45;&gt;40 -->
<g id="edge44" class="edge">
<title>43&#45;&gt;40</title>
<path fill="none" stroke="#000000" d="M395.2693,-506.7307C405.197,-496.803 418.3153,-483.6847 429.4363,-472.5637"/>
<polygon fill="#000000" stroke="#000000" points="432.1564,-474.7933 436.7527,-465.2473 427.2067,-469.8436 432.1564,-474.7933"/>
</g>
<!-- S30 -->
<g id="node12" class="node">
<title>S30</title>
<ellipse fill="none" stroke="#000000" cx="961" cy="-450" rx="27" ry="18"/>
<text text-anchor="middle" x="961" y="-445.8" font-family="Times,serif" font-size="14.00" fill="#000000">S30</text>
</g>
<!-- 31 -->
<g id="node13" class="node">
<title>31</title>
<ellipse fill="none" stroke="#000000" cx="752" cy="-306" rx="27" ry="18"/>
<text text-anchor="middle" x="752" y="-301.8" font-family="Times,serif" font-size="14.00" fill="#000000">31</text>
</g>
<!-- S30&#45;&gt;31 -->
<g id="edge8" class="edge">
<title>S30&#45;&gt;31</title>
<path fill="none" stroke="#000000" d="M942.084,-436.967C904.9515,-411.3828 822.3986,-354.5043 779.3343,-324.8332"/>
<polygon fill="#000000" stroke="#000000" points="781.2443,-321.8989 771.0238,-319.1073 777.2727,-327.6631 781.2443,-321.8989"/>
</g>
<!-- 33 -->
<g id="node14" class="node">
<title>33</title>
<ellipse fill="none" stroke="#000000" cx="989" cy="-378" rx="27" ry="18"/>
<text text-anchor="middle" x="989" y="-373.8" font-family="Times,serif" font-size="14.00" fill="#000000">33</text>
</g>
<!-- S30&#45;&gt;33 -->
<g id="edge9" class="edge">
<title>S30&#45;&gt;33</title>
<path fill="none" stroke="#000000" d="M967.778,-432.5708C970.9872,-424.3187 974.8935,-414.2738 978.4758,-405.0623"/>
<polygon fill="#000000" stroke="#000000" points="981.8248,-406.1069 982.1874,-395.5182 975.3008,-403.5697 981.8248,-406.1069"/>
</g>
<!-- 31&#45;&gt;T1 -->
<g id="edge25" class="edge">
<title>31&#45;&gt;T1</title>
<path fill="none" stroke="#000000" d="M747.8071,-288.0946C742.8539,-269.1821 733.4176,-238.9782 719,-216 692.4545,-173.6928 649.8389,-133.8719 622.6455,-110.7206"/>
<polygon fill="#000000" stroke="#000000" points="624.6471,-107.8313 614.7361,-104.0866 620.1487,-113.1946 624.6471,-107.8313"/>
</g>
<!-- 32 -->
<g id="node27" class="node">
<title>32</title>
<ellipse fill="none" stroke="#000000" cx="683" cy="-234" rx="27" ry="18"/>
<text text-anchor="middle" x="683" y="-229.8" font-family="Times,serif" font-size="14.00" fill="#000000">32</text>
</g>
<!-- 31&#45;&gt;32 -->
<g id="edge26" class="edge">
<title>31&#45;&gt;32</title>
<path fill="none" stroke="#000000" d="M737.3669,-290.7307C727.8529,-280.803 715.2812,-267.6847 704.6235,-256.5637"/>
<polygon fill="#000000" stroke="#000000" points="707.0581,-254.0456 697.612,-249.2473 702.0041,-258.8889 707.0581,-254.0456"/>
</g>
<!-- T30 -->
<g id="node28" class="node">
<title>T30</title>
<ellipse fill="none" stroke="#000000" cx="1017" cy="-162" rx="27" ry="18"/>
<text text-anchor="middle" x="1017" y="-157.8" font-family="Times,serif" font-size="14.00" fill="#000000">T30</text>
</g>
<!-- 33&#45;&gt;T30 -->
<g id="edge27" class="edge">
<title>33&#45;&gt;T30</title>
<path fill="none" stroke="#000000" d="M990.8252,-359.9839C993.9235,-330.0375 1000.6006,-268.1487 1008,-216 1009.2017,-207.5309 1010.6708,-198.3425 1012.0708,-189.9872"/>
<polygon fill="#000000" stroke="#000000" points="1015.5487,-190.4128 1013.7818,-179.9663 1008.6486,-189.2346 1015.5487,-190.4128"/>
</g>
<!-- 34 -->
<g id="node29" class="node">
<title>34</title>
<ellipse fill="none" stroke="#000000" cx="1044" cy="-306" rx="27" ry="18"/>
<text text-anchor="middle" x="1044" y="-301.8" font-family="Times,serif" font-size="14.00" fill="#000000">34</text>
</g>
<!-- 33&#45;&gt;34 -->
<g id="edge28" class="edge">
<title>33&#45;&gt;34</title>
<path fill="none" stroke="#000000" d="M1001.4804,-361.6621C1008.5124,-352.4564 1017.4347,-340.7764 1025.2883,-330.4953"/>
<polygon fill="#000000" stroke="#000000" points="1028.28,-332.3446 1031.569,-322.2733 1022.7172,-328.0953 1028.28,-332.3446"/>
</g>
<!-- 4 -->
<g id="node30" class="node">
<title>4</title>
<ellipse fill="none" stroke="#000000" cx="330" cy="-306" rx="27" ry="18"/>
<text text-anchor="middle" x="330" y="-301.8" font-family="Times,serif" font-size="14.00" fill="#000000">4</text>
</g>
<!-- 42&#45;&gt;4 -->
<g id="edge29" class="edge">
<title>42&#45;&gt;4</title>
<path fill="none" stroke="#000000" d="M308.778,-360.5708C311.9872,-352.3187 315.8935,-342.2738 319.4758,-333.0623"/>
<polygon fill="#000000" stroke="#000000" points="322.8248,-334.1069 323.1874,-323.5182 316.3008,-331.5697 322.8248,-334.1069"/>
</g>
<!-- 26&#45;&gt;4 -->
<g id="edge30" class="edge">
<title>26&#45;&gt;4</title>
<path fill="none" stroke="#000000" d="M248.8092,-364.4574C264.1302,-353.4263 285.9566,-337.7113 303.1211,-325.3528"/>
<polygon fill="#000000" stroke="#000000" points="305.5427,-327.9221 311.613,-319.2387 301.4525,-322.2414 305.5427,-327.9221"/>
</g>
<!-- 3&#45;&gt;4 -->
<g id="edge31" class="edge">
<title>3&#45;&gt;4</title>
<path fill="none" stroke="#000000" d="M395.4061,-363.4297C383.6246,-353.0851 367.616,-339.0286 354.3855,-327.4116"/>
<polygon fill="#000000" stroke="#000000" points="356.393,-324.5166 346.5692,-320.5486 351.7744,-329.7767 356.393,-324.5166"/>
</g>
<!-- 15 -->
<g id="node31" class="node">
<title>15</title>
<ellipse fill="none" stroke="#000000" cx="597" cy="-234" rx="27" ry="18"/>
<text text-anchor="middle" x="597" y="-229.8" font-family="Times,serif" font-size="14.00" fill="#000000">15</text>
</g>
<!-- 16&#45;&gt;15 -->
<g id="edge32" class="edge">
<title>16&#45;&gt;15</title>
<path fill="none" stroke="#000000" d="M631.563,-289.3008C626.0765,-280.5224 619.2314,-269.5703 613.0837,-259.7339"/>
<polygon fill="#000000" stroke="#000000" points="615.9609,-257.7336 607.6929,-251.1086 610.0249,-261.4436 615.9609,-257.7336"/>
</g>
<!-- 17&#45;&gt;19 -->
<g id="edge33" class="edge">
<title>17&#45;&gt;19</title>
<path fill="none" stroke="#000000" d="M627.7949,-433.3008C622.4304,-424.5224 615.7374,-413.5703 609.7263,-403.7339"/>
<polygon fill="#000000" stroke="#000000" points="612.6563,-401.8164 604.4553,-395.1086 606.6833,-405.4666 612.6563,-401.8164"/>
</g>
<!-- 29 -->
<g id="node33" class="node">
<title>29</title>
<ellipse fill="none" stroke="#000000" cx="1044" cy="-234" rx="27" ry="18"/>
<text text-anchor="middle" x="1044" y="-229.8" font-family="Times,serif" font-size="14.00" fill="#000000">29</text>
</g>
<!-- 18&#45;&gt;29 -->
<g id="edge34" class="edge">
<title>18&#45;&gt;29</title>
<path fill="none" stroke="#000000" d="M1100.7307,-290.7307C1090.803,-280.803 1077.6847,-267.6847 1066.5637,-256.5637"/>
<polygon fill="#000000" stroke="#000000" points="1068.7933,-253.8436 1059.2473,-249.2473 1063.8436,-258.7933 1068.7933,-253.8436"/>
</g>
<!-- 11&#45;&gt;4 -->
<g id="edge35" class="edge">
<title>11&#45;&gt;4</title>
<path fill="none" stroke="#000000" d="M462.3574,-367.0276C457.6399,-364.6783 452.6642,-362.2325 448,-360 419.0657,-346.1509 385.8149,-331.0027 361.9996,-320.2846"/>
<polygon fill="#000000" stroke="#000000" points="363.2855,-317.0254 352.7292,-316.1217 360.4179,-323.4111 363.2855,-317.0254"/>
</g>
<!-- 14&#45;&gt;15 -->
<g id="edge36" class="edge">
<title>14&#45;&gt;15</title>
<path fill="none" stroke="#000000" d="M758.2108,-363.3686C746.5285,-352.5262 730.2407,-337.3744 716,-324 699.0418,-308.0734 696.189,-302.505 678,-288 661.5415,-274.875 641.924,-261.7387 626.1175,-251.7091"/>
<polygon fill="#000000" stroke="#000000" points="627.6362,-248.5304 617.3039,-246.1864 623.9193,-254.4621 627.6362,-248.5304"/>
</g>
<!-- 13&#45;&gt;19 -->
<g id="edge41" class="edge">
<title>13&#45;&gt;19</title>
<path fill="none" stroke="#000000" d="M725.6071,-439.5306C699.1858,-427.1778 655.0915,-406.5622 625.2997,-392.6336"/>
<polygon fill="#000000" stroke="#000000" points="626.7113,-389.43 616.1701,-388.3652 623.7466,-395.7712 626.7113,-389.43"/>
</g>
<!-- 12&#45;&gt;29 -->
<g id="edge42" class="edge">
<title>12&#45;&gt;29</title>
<path fill="none" stroke="#000000" d="M1150.6363,-360.6721C1157.8515,-341.4334 1165.7042,-310.1738 1152,-288 1136.4049,-262.7666 1105.0527,-248.93 1080.1277,-241.6006"/>
<polygon fill="#000000" stroke="#000000" points="1080.8163,-238.1612 1070.2493,-238.9289 1078.9887,-244.9184 1080.8163,-238.1612"/>
</g>
<!-- 23 -->
<g id="node39" class="node">
<title>23</title>
<ellipse fill="none" stroke="#000000" cx="264" cy="-162" rx="27" ry="18"/>
<text text-anchor="middle" x="264" y="-157.8" font-family="Times,serif" font-size="14.00" fill="#000000">23</text>
</g>
<!-- 32&#45;&gt;23 -->
<g id="edge46" class="edge">
<title>32&#45;&gt;23</title>
<path fill="none" stroke="#000000" d="M659.8975,-224.5912C651.5365,-221.4786 641.9494,-218.2417 633,-216 513.7694,-186.1348 368.4496,-170.8677 301.3041,-164.9715"/>
<polygon fill="#000000" stroke="#000000" points="301.4777,-161.4736 291.2149,-164.1048 300.8786,-168.4479 301.4777,-161.4736"/>
</g>
<!-- 34&#45;&gt;29 -->
<g id="edge47" class="edge">
<title>34&#45;&gt;29</title>
<path fill="none" stroke="#000000" d="M1044,-287.8314C1044,-280.131 1044,-270.9743 1044,-262.4166"/>
<polygon fill="#000000" stroke="#000000" points="1047.5001,-262.4132 1044,-252.4133 1040.5001,-262.4133 1047.5001,-262.4132"/>
</g>
<!-- 5 -->
<g id="node40" class="node">
<title>5</title>
<ellipse fill="none" stroke="#000000" cx="192" cy="-234" rx="27" ry="18"/>
<text text-anchor="middle" x="192" y="-229.8" font-family="Times,serif" font-size="14.00" fill="#000000">5</text>
</g>
<!-- 4&#45;&gt;5 -->
<g id="edge52" class="edge">
<title>4&#45;&gt;5</title>
<path fill="none" stroke="#000000" d="M308.4375,-294.75C285.3476,-282.7031 248.5212,-263.4893 222.4742,-249.8996"/>
<polygon fill="#000000" stroke="#000000" points="223.8959,-246.6937 213.4111,-245.171 220.6579,-252.8998 223.8959,-246.6937"/>
</g>
<!-- 15&#45;&gt;T1 -->
<g id="edge63" class="edge">
<title>15&#45;&gt;T1</title>
<path fill="none" stroke="#000000" d="M597,-215.7623C597,-191.201 597,-147.2474 597,-118.3541"/>
<polygon fill="#000000" stroke="#000000" points="600.5001,-118.0896 597,-108.0896 593.5001,-118.0897 600.5001,-118.0896"/>
</g>
<!-- 21 -->
<g id="node41" class="node">
<title>21</title>
<ellipse fill="none" stroke="#000000" cx="498" cy="-306" rx="27" ry="18"/>
<text text-anchor="middle" x="498" y="-301.8" font-family="Times,serif" font-size="14.00" fill="#000000">21</text>
</g>
<!-- 19&#45;&gt;21 -->
<g id="edge53" class="edge">
<title>19&#45;&gt;21</title>
<path fill="none" stroke="#000000" d="M575.9431,-364.4574C561.3275,-353.4956 540.545,-337.9088 524.1152,-325.5864"/>
<polygon fill="#000000" stroke="#000000" points="526.0759,-322.682 515.9759,-319.4819 521.8759,-328.282 526.0759,-322.682"/>
</g>
<!-- 20 -->
<g id="node42" class="node">
<title>20</title>
<ellipse fill="none" stroke="#000000" cx="570" cy="-306" rx="27" ry="18"/>
<text text-anchor="middle" x="570" y="-301.8" font-family="Times,serif" font-size="14.00" fill="#000000">20</text>
</g>
<!-- 19&#45;&gt;20 -->
<g id="edge54" class="edge">
<title>19&#45;&gt;20</title>
<path fill="none" stroke="#000000" d="M588.0674,-360.2022C585.3645,-352.0936 582.1043,-342.3129 579.1016,-333.3049"/>
<polygon fill="#000000" stroke="#000000" points="582.3471,-331.973 575.8643,-323.593 575.7063,-334.1867 582.3471,-331.973"/>
</g>
<!-- 28 -->
<g id="node43" class="node">
<title>28</title>
<ellipse fill="none" stroke="#000000" cx="824" cy="-306" rx="27" ry="18"/>
<text text-anchor="middle" x="824" y="-301.8" font-family="Times,serif" font-size="14.00" fill="#000000">28</text>
</g>
<!-- 19&#45;&gt;28 -->
<g id="edge55" class="edge">
<title>19&#45;&gt;28</title>
<path fill="none" stroke="#000000" d="M619.9291,-372.4568C657.6207,-364.0261 729.4367,-346.5505 788,-324 789.8585,-323.2844 791.7493,-322.505 793.6423,-321.6849"/>
<polygon fill="#000000" stroke="#000000" points="795.3856,-324.7346 802.9851,-317.3523 792.4406,-318.3842 795.3856,-324.7346"/>
</g>
<!-- 29&#45;&gt;T30 -->
<g id="edge66" class="edge">
<title>29&#45;&gt;T30</title>
<path fill="none" stroke="#000000" d="M1037.3258,-216.2022C1034.2524,-208.0064 1030.5384,-198.1024 1027.1305,-189.0145"/>
<polygon fill="#000000" stroke="#000000" points="1030.3858,-187.7274 1023.5974,-179.593 1023.8315,-190.1853 1030.3858,-187.7274"/>
</g>
<!-- 37 -->
<g id="node34" class="node">
<title>37</title>
<ellipse fill="none" stroke="#000000" cx="452" cy="-522" rx="27" ry="18"/>
<text text-anchor="middle" x="452" y="-517.8" font-family="Times,serif" font-size="14.00" fill="#000000">37</text>
</g>
<!-- 39 -->
<g id="node35" class="node">
<title>39</title>
<ellipse fill="none" stroke="#000000" cx="380" cy="-450" rx="27" ry="18"/>
<text text-anchor="middle" x="380" y="-445.8" font-family="Times,serif" font-size="14.00" fill="#000000">39</text>
</g>
<!-- 37&#45;&gt;39 -->
<g id="edge37" class="edge">
<title>37&#45;&gt;39</title>
<path fill="none" stroke="#000000" d="M436.7307,-506.7307C426.803,-496.803 413.6847,-483.6847 402.5637,-472.5637"/>
<polygon fill="#000000" stroke="#000000" points="404.7933,-469.8436 395.2473,-465.2473 399.8436,-474.7933 404.7933,-469.8436"/>
</g>
<!-- 41 -->
<g id="node36" class="node">
<title>41</title>
<ellipse fill="none" stroke="#000000" cx="934" cy="-306" rx="27" ry="18"/>
<text text-anchor="middle" x="934" y="-301.8" font-family="Times,serif" font-size="14.00" fill="#000000">41</text>
</g>
<!-- 37&#45;&gt;41 -->
<g id="edge38" class="edge">
<title>37&#45;&gt;41</title>
<path fill="none" stroke="#000000" d="M472.1774,-509.4238C500.7906,-491.6977 554.9183,-458.5622 602,-432 661.5666,-398.3941 674.4324,-385.2328 738,-360 767.1877,-348.4141 850.4969,-326.8445 898.5868,-314.7681"/>
<polygon fill="#000000" stroke="#000000" points="899.717,-318.0933 908.5685,-312.2708 898.018,-311.3026 899.717,-318.0933"/>
</g>
<!-- 37&#45;&gt;38 -->
<g id="edge39" class="edge">
<title>37&#45;&gt;38</title>
<path fill="none" stroke="#000000" d="M430.1295,-511.0647C405.7778,-498.8889 366.238,-479.119 338.7715,-465.3858"/>
<polygon fill="#000000" stroke="#000000" points="340.114,-462.1439 329.6045,-460.8022 336.9835,-468.4049 340.114,-462.1439"/>
</g>
<!-- 37&#45;&gt;40 -->
<g id="edge40" class="edge">
<title>37&#45;&gt;40</title>
<path fill="none" stroke="#000000" d="M452,-503.8314C452,-496.131 452,-486.9743 452,-478.4166"/>
<polygon fill="#000000" stroke="#000000" points="455.5001,-478.4132 452,-468.4133 448.5001,-478.4133 455.5001,-478.4132"/>
</g>
<!-- 39&#45;&gt;15 -->
<g id="edge48" class="edge">
<title>39&#45;&gt;15</title>
<path fill="none" stroke="#000000" d="M401.4884,-438.6846C406.2155,-436.3567 411.2342,-434.0062 416,-432 461.0815,-413.0224 491.6285,-435.8441 520,-396 529.2806,-382.9666 527.778,-373.9822 520,-360 505.2511,-333.4865 476.7489,-350.5135 462,-324 454.222,-310.0178 453.0299,-301.2491 462,-288 483.6784,-255.9802 527.7501,-242.9453 559.654,-237.6398"/>
<polygon fill="#000000" stroke="#000000" points="560.5748,-241.042 569.9572,-236.1207 559.5536,-234.1169 560.5748,-241.042"/>
</g>
<!-- 41&#45;&gt;29 -->
<g id="edge49" class="edge">
<title>41&#45;&gt;29</title>
<path fill="none" stroke="#000000" d="M953.4126,-293.2936C970.742,-281.9507 996.3318,-265.201 1015.8972,-252.3946"/>
<polygon fill="#000000" stroke="#000000" points="1017.9613,-255.2267 1024.4115,-246.8216 1014.1276,-249.3698 1017.9613,-255.2267"/>
</g>
<!-- 38&#45;&gt;4 -->
<g id="edge50" class="edge">
<title>38&#45;&gt;4</title>
<path fill="none" stroke="#000000" d="M320.1069,-433.4411C326.8212,-423.2105 334.5028,-409.4962 338,-396 343.2958,-375.563 340.8122,-351.7396 337.2652,-333.739"/>
<polygon fill="#000000" stroke="#000000" points="340.6648,-332.9016 335.1046,-323.883 333.8271,-334.4005 340.6648,-332.9016"/>
</g>
<!-- 40&#45;&gt;19 -->
<g id="edge51" class="edge">
<title>40&#45;&gt;19</title>
<path fill="none" stroke="#000000" d="M473.5667,-439.0647C497.4414,-426.9593 536.1206,-407.3473 563.185,-393.6245"/>
<polygon fill="#000000" stroke="#000000" points="564.8941,-396.6822 572.2303,-389.0382 561.7284,-390.4389 564.8941,-396.6822"/>
</g>
<!-- 23&#45;&gt;T1 -->
<g id="edge69" class="edge">
<title>23&#45;&gt;T1</title>
<path fill="none" stroke="#000000" d="M285.7738,-151.3285C291.8859,-148.6407 298.6097,-145.9647 305,-144 394.5789,-116.459 504.1752,-100.8028 560.1917,-94.0398"/>
<polygon fill="#000000" stroke="#000000" points="560.8143,-97.4907 570.3349,-92.8422 559.9935,-90.539 560.8143,-97.4907"/>
</g>
<!-- 23&#45;&gt;T24 -->
<g id="edge68" class="edge">
<title>23&#45;&gt;T24</title>
<path fill="none" stroke="#000000" d="M243.0623,-150.4384C238.2154,-148.0715 233.008,-145.7672 228,-144 157.219,-119.0233 133.781,-132.9767 63,-108 61.122,-107.3373 59.216,-106.5991 57.3114,-105.8103"/>
<polygon fill="#000000" stroke="#000000" points="58.4907,-102.5022 47.9377,-101.5616 55.6009,-108.8778 58.4907,-102.5022"/>
</g>
<!-- 5&#45;&gt;23 -->
<g id="edge58" class="edge">
<title>5&#45;&gt;23</title>
<path fill="none" stroke="#000000" d="M207.2693,-218.7307C217.197,-208.803 230.3153,-195.6847 241.4363,-184.5637"/>
<polygon fill="#000000" stroke="#000000" points="244.1564,-186.7933 248.7527,-177.2473 239.2067,-181.8436 244.1564,-186.7933"/>
</g>
<!-- 6 -->
<g id="node44" class="node">
<title>6</title>
<ellipse fill="none" stroke="#000000" cx="82" cy="-162" rx="27" ry="18"/>
<text text-anchor="middle" x="82" y="-157.8" font-family="Times,serif" font-size="14.00" fill="#000000">6</text>
</g>
<!-- 5&#45;&gt;6 -->
<g id="edge56" class="edge">
<title>5&#45;&gt;6</title>
<path fill="none" stroke="#000000" d="M172.5874,-221.2936C155.258,-209.9507 129.6682,-193.201 110.1028,-180.3946"/>
<polygon fill="#000000" stroke="#000000" points="111.8724,-177.3698 101.5885,-174.8216 108.0387,-183.2267 111.8724,-177.3698"/>
</g>
<!-- T35 -->
<g id="node45" class="node">
<title>T35</title>
<ellipse fill="none" stroke="#000000" cx="192" cy="-162" rx="27" ry="18"/>
<text text-anchor="middle" x="192" y="-157.8" font-family="Times,serif" font-size="14.00" fill="#000000">T35</text>
</g>
<!-- 5&#45;&gt;T35 -->
<g id="edge57" class="edge">
<title>5&#45;&gt;T35</title>
<path fill="none" stroke="#000000" d="M192,-215.8314C192,-208.131 192,-198.9743 192,-190.4166"/>
<polygon fill="#000000" stroke="#000000" points="195.5001,-190.4132 192,-180.4133 188.5001,-190.4133 195.5001,-190.4132"/>
</g>
<!-- 22 -->
<g id="node46" class="node">
<title>22</title>
<ellipse fill="none" stroke="#000000" cx="264" cy="-234" rx="27" ry="18"/>
<text text-anchor="middle" x="264" y="-229.8" font-family="Times,serif" font-size="14.00" fill="#000000">22</text>
</g>
<!-- 21&#45;&gt;22 -->
<g id="edge59" class="edge">
<title>21&#45;&gt;22</title>
<path fill="none" stroke="#000000" d="M473.4002,-298.4308C431.443,-285.5209 345.9599,-259.2184 298.2089,-244.5258"/>
<polygon fill="#000000" stroke="#000000" points="299.2085,-241.1715 288.6213,-241.5758 297.1498,-247.862 299.2085,-241.1715"/>
</g>
<!-- 20&#45;&gt;15 -->
<g id="edge60" class="edge">
<title>20&#45;&gt;15</title>
<path fill="none" stroke="#000000" d="M576.6742,-288.2022C579.7476,-280.0064 583.4616,-270.1024 586.8695,-261.0145"/>
<polygon fill="#000000" stroke="#000000" points="590.1685,-262.1853 590.4026,-251.593 583.6142,-259.7274 590.1685,-262.1853"/>
</g>
<!-- 28&#45;&gt;29 -->
<g id="edge61" class="edge">
<title>28&#45;&gt;29</title>
<path fill="none" stroke="#000000" d="M848.3844,-298.0196C887.6995,-285.1529 965.2006,-259.7889 1009.9467,-245.1447"/>
<polygon fill="#000000" stroke="#000000" points="1011.091,-248.453 1019.5064,-242.0161 1008.9137,-241.8002 1011.091,-248.453"/>
</g>
<!-- 7 -->
<g id="node47" class="node">
<title>7</title>
<ellipse fill="none" stroke="#000000" cx="99" cy="-90" rx="27" ry="18"/>
<text text-anchor="middle" x="99" y="-85.8" font-family="Times,serif" font-size="14.00" fill="#000000">7</text>
</g>
<!-- 6&#45;&gt;7 -->
<g id="edge62" class="edge">
<title>6&#45;&gt;7</title>
<path fill="none" stroke="#000000" d="M86.2022,-144.2022C88.0821,-136.2406 90.3425,-126.6671 92.4371,-117.7957"/>
<polygon fill="#000000" stroke="#000000" points="95.8955,-118.3792 94.7872,-107.8425 89.0828,-116.7706 95.8955,-118.3792"/>
</g>
<!-- 22&#45;&gt;23 -->
<g id="edge64" class="edge">
<title>22&#45;&gt;23</title>
<path fill="none" stroke="#000000" d="M264,-215.8314C264,-208.131 264,-198.9743 264,-190.4166"/>
<polygon fill="#000000" stroke="#000000" points="267.5001,-190.4132 264,-180.4133 260.5001,-190.4133 267.5001,-190.4132"/>
</g>
<!-- 22&#45;&gt;T35 -->
<g id="edge65" class="edge">
<title>22&#45;&gt;T35</title>
<path fill="none" stroke="#000000" d="M248.7307,-218.7307C238.803,-208.803 225.6847,-195.6847 214.5637,-184.5637"/>
<polygon fill="#000000" stroke="#000000" points="216.7933,-181.8436 207.2473,-177.2473 211.8436,-186.7933 216.7933,-181.8436"/>
</g>
<!-- T8 -->
<g id="node48" class="node">
<title>T8</title>
<ellipse fill="none" stroke="#000000" cx="99" cy="-18" rx="27" ry="18"/>
<text text-anchor="middle" x="99" y="-13.8" font-family="Times,serif" font-size="14.00" fill="#000000">T8</text>
</g>
<!-- 7&#45;&gt;T8 -->
<g id="edge67" class="edge">
<title>7&#45;&gt;T8</title>
<path fill="none" stroke="#000000" d="M99,-71.8314C99,-64.131 99,-54.9743 99,-46.4166"/>
<polygon fill="#000000" stroke="#000000" points="102.5001,-46.4132 99,-36.4133 95.5001,-46.4133 102.5001,-46.4132"/>
</g>
</g>
</svg>
</div>
<blockquote>
<p>图1-2b. 图文件</p>
</blockquote>
<pre><code>digraph world_dynamics {
    size=&quot;6,6&quot;;
    S8 -&gt; 9; S24 -&gt; 27; S24 -&gt; 25; S1 -&gt; 10; S1 -&gt; 2; S35 -&gt; 36;
    S35 -&gt; 43; S30 -&gt; 31; S30 -&gt; 33; 9 -&gt; 42; 9 -&gt; T1; 25 -&gt; T1;
    25 -&gt; 26; 27 -&gt; T24; 2 -&gt; 3; 2 -&gt; 16; 2 -&gt; 17; 2 -&gt; T1; 2 -&gt; 18;
    10 -&gt; 11; 10 -&gt; 14; 10 -&gt; T1; 10 -&gt; 13; 10 -&gt; 12;
    31 -&gt; T1; 31 -&gt; 32; 33 -&gt; T30; 33 -&gt; 34; 42 -&gt; 4; 26 -&gt; 4;
    3 -&gt; 4; 16 -&gt; 15; 17 -&gt; 19; 18 -&gt; 29; 11 -&gt; 4; 14 -&gt; 15;
    37 -&gt; 39; 37 -&gt; 41; 37 -&gt; 38; 37 -&gt; 40; 13 -&gt; 19; 12 -&gt; 29;
    43 -&gt; 38; 43 -&gt; 40; 36 -&gt; 19; 32 -&gt; 23; 34 -&gt; 29; 39 -&gt; 15;
    41 -&gt; 29; 38 -&gt; 4; 40 -&gt; 19; 4 -&gt; 5; 19 -&gt; 21; 19 -&gt; 20;
    19 -&gt; 28; 5 -&gt; 6; 5 -&gt; T35; 5 -&gt; 23; 21 -&gt; 22; 20 -&gt; 15; 28 -&gt; 29;
    6 -&gt; 7; 15 -&gt; T1; 22 -&gt; 23; 22 -&gt; T35; 29 -&gt; T30; 7 -&gt; T8;
    23 -&gt; T24; 23 -&gt; T1;
}
</code></pre>
<blockquote>
<p>图1-3a. (Sun-4/28机器上渲染用时0.5秒)</p>
</blockquote>
<div class="viz-graph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: shells Pages: 1 -->
<svg width="430pt" height="576pt"
 viewBox="0.00 0.00 430.07 576.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(.8229 .8229) rotate(0) translate(4 696)">
<title>shells</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-696 518.6512,-696 518.6512,4 -4,4"/>
<!-- 1972 -->
<g id="node1" class="node">
<title>1972</title>
<text text-anchor="middle" x="36.6512" y="-666.4" font-family="Times,serif" font-size="24.00" fill="#000000">1972</text>
</g>
<!-- 1976 -->
<g id="node2" class="node">
<title>1976</title>
<text text-anchor="middle" x="36.6512" y="-593.6" font-family="Times,serif" font-size="24.00" fill="#000000">1976</text>
</g>
<!-- 1972&#45;&gt;1976 -->
<g id="edge1" class="edge">
<title>1972&#45;&gt;1976</title>
<path fill="none" stroke="#000000" d="M36.6512,-655.2295C36.6512,-647.3836 36.6512,-638.0426 36.6512,-629.3328"/>
<polygon fill="#000000" stroke="#000000" points="40.1513,-629.1646 36.6512,-619.1646 33.1513,-629.1647 40.1513,-629.1646"/>
</g>
<!-- 1978 -->
<g id="node3" class="node">
<title>1978</title>
<text text-anchor="middle" x="36.6512" y="-520.8" font-family="Times,serif" font-size="24.00" fill="#000000">1978</text>
</g>
<!-- 1976&#45;&gt;1978 -->
<g id="edge2" class="edge">
<title>1976&#45;&gt;1978</title>
<path fill="none" stroke="#000000" d="M36.6512,-582.4295C36.6512,-574.5836 36.6512,-565.2426 36.6512,-556.5328"/>
<polygon fill="#000000" stroke="#000000" points="40.1513,-556.3646 36.6512,-546.3646 33.1513,-556.3647 40.1513,-556.3646"/>
</g>
<!-- 1980 -->
<g id="node4" class="node">
<title>1980</title>
<text text-anchor="middle" x="36.6512" y="-448" font-family="Times,serif" font-size="24.00" fill="#000000">1980</text>
</g>
<!-- 1978&#45;&gt;1980 -->
<g id="edge3" class="edge">
<title>1978&#45;&gt;1980</title>
<path fill="none" stroke="#000000" d="M36.6512,-509.6295C36.6512,-501.7836 36.6512,-492.4426 36.6512,-483.7328"/>
<polygon fill="#000000" stroke="#000000" points="40.1513,-483.5646 36.6512,-473.5646 33.1513,-483.5647 40.1513,-483.5646"/>
</g>
<!-- 1982 -->
<g id="node5" class="node">
<title>1982</title>
<text text-anchor="middle" x="36.6512" y="-375.2" font-family="Times,serif" font-size="24.00" fill="#000000">1982</text>
</g>
<!-- 1980&#45;&gt;1982 -->
<g id="edge4" class="edge">
<title>1980&#45;&gt;1982</title>
<path fill="none" stroke="#000000" d="M36.6512,-436.8295C36.6512,-428.9836 36.6512,-419.6426 36.6512,-410.9328"/>
<polygon fill="#000000" stroke="#000000" points="40.1513,-410.7646 36.6512,-400.7646 33.1513,-410.7647 40.1513,-410.7646"/>
</g>
<!-- 1984 -->
<g id="node6" class="node">
<title>1984</title>
<text text-anchor="middle" x="36.6512" y="-302.4" font-family="Times,serif" font-size="24.00" fill="#000000">1984</text>
</g>
<!-- 1982&#45;&gt;1984 -->
<g id="edge5" class="edge">
<title>1982&#45;&gt;1984</title>
<path fill="none" stroke="#000000" d="M36.6512,-364.0295C36.6512,-356.1836 36.6512,-346.8426 36.6512,-338.1328"/>
<polygon fill="#000000" stroke="#000000" points="40.1513,-337.9646 36.6512,-327.9646 33.1513,-337.9647 40.1513,-337.9646"/>
</g>
<!-- 1986 -->
<g id="node7" class="node">
<title>1986</title>
<text text-anchor="middle" x="36.6512" y="-229.6" font-family="Times,serif" font-size="24.00" fill="#000000">1986</text>
</g>
<!-- 1984&#45;&gt;1986 -->
<g id="edge6" class="edge">
<title>1984&#45;&gt;1986</title>
<path fill="none" stroke="#000000" d="M36.6512,-291.2295C36.6512,-283.3836 36.6512,-274.0426 36.6512,-265.3328"/>
<polygon fill="#000000" stroke="#000000" points="40.1513,-265.1646 36.6512,-255.1646 33.1513,-265.1647 40.1513,-265.1646"/>
</g>
<!-- v9sh -->
<g id="node19" class="node">
<title>v9sh</title>
<polygon fill="none" stroke="#000000" points="178.6512,-327.6 124.6512,-327.6 124.6512,-291.6 178.6512,-291.6 178.6512,-327.6"/>
<text text-anchor="middle" x="151.6512" y="-303.6" font-family="Times,serif" font-size="20.00" fill="#000000">v9sh</text>
</g>
<!-- 1984&#45;&gt;v9sh -->
<!-- 1988 -->
<g id="node8" class="node">
<title>1988</title>
<text text-anchor="middle" x="36.6512" y="-156.8" font-family="Times,serif" font-size="24.00" fill="#000000">1988</text>
</g>
<!-- 1986&#45;&gt;1988 -->
<g id="edge7" class="edge">
<title>1986&#45;&gt;1988</title>
<path fill="none" stroke="#000000" d="M36.6512,-218.4295C36.6512,-210.5836 36.6512,-201.2426 36.6512,-192.5328"/>
<polygon fill="#000000" stroke="#000000" points="40.1513,-192.3646 36.6512,-182.3646 33.1513,-192.3647 40.1513,-192.3646"/>
</g>
<!-- 1990 -->
<g id="node9" class="node">
<title>1990</title>
<text text-anchor="middle" x="36.6512" y="-84" font-family="Times,serif" font-size="24.00" fill="#000000">1990</text>
</g>
<!-- 1988&#45;&gt;1990 -->
<g id="edge8" class="edge">
<title>1988&#45;&gt;1990</title>
<path fill="none" stroke="#000000" d="M36.6512,-145.6295C36.6512,-137.7836 36.6512,-128.4426 36.6512,-119.7328"/>
<polygon fill="#000000" stroke="#000000" points="40.1513,-119.5646 36.6512,-109.5646 33.1513,-119.5647 40.1513,-119.5646"/>
</g>
<!-- rc -->
<g id="node24" class="node">
<title>rc</title>
<polygon fill="none" stroke="#000000" points="178.6512,-182 124.6512,-182 124.6512,-146 178.6512,-146 178.6512,-182"/>
<text text-anchor="middle" x="151.6512" y="-158" font-family="Times,serif" font-size="20.00" fill="#000000">rc</text>
</g>
<!-- 1988&#45;&gt;rc -->
<!-- future -->
<g id="node10" class="node">
<title>future</title>
<text text-anchor="middle" x="36.6512" y="-11.2" font-family="Times,serif" font-size="24.00" fill="#000000">future</text>
</g>
<!-- 1990&#45;&gt;future -->
<g id="edge9" class="edge">
<title>1990&#45;&gt;future</title>
<path fill="none" stroke="#000000" d="M36.6512,-72.8295C36.6512,-64.9836 36.6512,-55.6426 36.6512,-46.9328"/>
<polygon fill="#000000" stroke="#000000" points="40.1513,-46.7646 36.6512,-36.7646 33.1513,-46.7647 40.1513,-46.7646"/>
</g>
<!-- Mashey -->
<g id="node11" class="node">
<title>Mashey</title>
<polygon fill="none" stroke="#000000" points="234.4638,-618.8 154.8386,-618.8 154.8386,-582.8 234.4638,-582.8 234.4638,-618.8"/>
<text text-anchor="middle" x="194.6512" y="-594.8" font-family="Times,serif" font-size="20.00" fill="#000000">Mashey</text>
</g>
<!-- Bourne -->
<g id="node12" class="node">
<title>Bourne</title>
<polygon fill="none" stroke="#000000" points="327.0253,-618.8 252.2771,-618.8 252.2771,-582.8 327.0253,-582.8 327.0253,-618.8"/>
<text text-anchor="middle" x="289.6512" y="-594.8" font-family="Times,serif" font-size="20.00" fill="#000000">Bourne</text>
</g>
<!-- Formshell -->
<g id="node13" class="node">
<title>Formshell</title>
<polygon fill="none" stroke="#000000" points="302.2573,-546 205.0451,-546 205.0451,-510 302.2573,-510 302.2573,-546"/>
<text text-anchor="middle" x="253.6512" y="-522" font-family="Times,serif" font-size="20.00" fill="#000000">Formshell</text>
</g>
<!-- Bourne&#45;&gt;Formshell -->
<g id="edge32" class="edge">
<title>Bourne&#45;&gt;Formshell</title>
<path fill="none" stroke="#000000" d="M280.5669,-582.4295C276.4856,-574.1762 271.5862,-564.2686 267.0926,-555.1814"/>
<polygon fill="#000000" stroke="#000000" points="270.178,-553.5249 262.6079,-546.1124 263.9033,-556.6278 270.178,-553.5249"/>
</g>
<!-- esh -->
<g id="node15" class="node">
<title>esh</title>
<polygon fill="none" stroke="#000000" points="383.6512,-473.2 329.6512,-473.2 329.6512,-437.2 383.6512,-437.2 383.6512,-473.2"/>
<text text-anchor="middle" x="356.6512" y="-449.2" font-family="Times,serif" font-size="20.00" fill="#000000">esh</text>
</g>
<!-- Bourne&#45;&gt;esh -->
<g id="edge14" class="edge">
<title>Bourne&#45;&gt;esh</title>
<path fill="none" stroke="#000000" d="M314.2233,-582.7932C325.3674,-573.2614 337.6035,-560.5944 344.6512,-546.4 354.3734,-526.819 357.1293,-502.1009 357.5891,-483.3389"/>
<polygon fill="#000000" stroke="#000000" points="361.089,-483.3478 357.6341,-473.3321 354.0891,-483.3162 361.089,-483.3478"/>
</g>
<!-- vsh -->
<g id="node16" class="node">
<title>vsh</title>
<polygon fill="none" stroke="#000000" points="224.6512,-473.2 170.6512,-473.2 170.6512,-437.2 224.6512,-437.2 224.6512,-473.2"/>
<text text-anchor="middle" x="197.6512" y="-449.2" font-family="Times,serif" font-size="20.00" fill="#000000">vsh</text>
</g>
<!-- Bourne&#45;&gt;vsh -->
<g id="edge15" class="edge">
<title>Bourne&#45;&gt;vsh</title>
<path fill="none" stroke="#000000" d="M252.0366,-583.841C228.764,-572.4898 202.1269,-557.6296 195.6512,-546.4 184.7036,-527.4157 186.1753,-502.3086 189.8389,-483.2444"/>
<polygon fill="#000000" stroke="#000000" points="193.2845,-483.873 192.0348,-473.3521 186.4509,-482.356 193.2845,-483.873"/>
</g>
<!-- ksh -->
<g id="node17" class="node">
<title>ksh</title>
<polygon fill="none" stroke="#000000" points="319.6512,-400.4 265.6512,-400.4 265.6512,-364.4 319.6512,-364.4 319.6512,-400.4"/>
<text text-anchor="middle" x="292.6512" y="-376.4" font-family="Times,serif" font-size="20.00" fill="#000000">ksh</text>
</g>
<!-- Bourne&#45;&gt;ksh -->
<g id="edge16" class="edge">
<title>Bourne&#45;&gt;ksh</title>
<path fill="none" stroke="#000000" d="M299.0126,-582.7102C303.8321,-572.3752 309.1998,-559 311.6512,-546.4 320.8381,-499.1791 309.8123,-443.3841 301.1284,-410.5541"/>
<polygon fill="#000000" stroke="#000000" points="304.4546,-409.4501 298.4198,-400.742 297.707,-411.3128 304.4546,-409.4501"/>
</g>
<!-- System&#45;V -->
<g id="node18" class="node">
<title>System&#45;V</title>
<polygon fill="none" stroke="#000000" points="459.6372,-400.4 363.6652,-400.4 363.6652,-364.4 459.6372,-364.4 459.6372,-400.4"/>
<text text-anchor="middle" x="411.6512" y="-376.4" font-family="Times,serif" font-size="20.00" fill="#000000">System&#45;V</text>
</g>
<!-- Bourne&#45;&gt;System&#45;V -->
<g id="edge17" class="edge">
<title>Bourne&#45;&gt;System&#45;V</title>
<path fill="none" stroke="#000000" d="M322.0634,-582.6746C336.3659,-573.36 352.4378,-560.9087 363.6512,-546.4 394.8891,-505.9822 405.8205,-445.7413 409.63,-410.6287"/>
<polygon fill="#000000" stroke="#000000" points="413.1221,-410.878 410.5982,-400.5882 406.1545,-410.206 413.1221,-410.878"/>
</g>
<!-- Bourne&#45;&gt;v9sh -->
<g id="edge18" class="edge">
<title>Bourne&#45;&gt;v9sh</title>
<path fill="none" stroke="#000000" d="M252.0138,-585.2414C225.5359,-573.6209 193.1891,-557.8381 183.6512,-546.4 133.6338,-486.4178 139.8758,-386.5935 146.6811,-337.9655"/>
<polygon fill="#000000" stroke="#000000" points="150.1761,-338.2611 148.2107,-327.8502 143.2548,-337.2145 150.1761,-338.2611"/>
</g>
<!-- Bash -->
<g id="node26" class="node">
<title>Bash</title>
<polygon fill="none" stroke="#000000" points="234.6452,-109.2 178.6572,-109.2 178.6572,-73.2 234.6452,-73.2 234.6452,-109.2"/>
<text text-anchor="middle" x="206.6512" y="-85.2" font-family="Times,serif" font-size="20.00" fill="#000000">Bash</text>
</g>
<!-- Bourne&#45;&gt;Bash -->
<g id="edge20" class="edge">
<title>Bourne&#45;&gt;Bash</title>
<path fill="none" stroke="#000000" d="M252.1607,-585.5319C214.1451,-570.0053 160.6141,-547.9992 158.6512,-546.4 120.6535,-515.4414 96.6512,-504.2129 96.6512,-455.2 96.6512,-455.2 96.6512,-455.2 96.6512,-236.8 96.6512,-195.3964 91.6382,-179.3289 115.6512,-145.6 128.8017,-127.1287 150.3676,-113.8376 169.2048,-105.0185"/>
<polygon fill="#000000" stroke="#000000" points="170.7319,-108.1702 178.4651,-100.928 167.9035,-101.7671 170.7319,-108.1702"/>
</g>
<!-- csh -->
<g id="node14" class="node">
<title>csh</title>
<polygon fill="none" stroke="#000000" points="493.6512,-546 439.6512,-546 439.6512,-510 493.6512,-510 493.6512,-546"/>
<text text-anchor="middle" x="466.6512" y="-522" font-family="Times,serif" font-size="20.00" fill="#000000">csh</text>
</g>
<!-- Formshell&#45;&gt;csh -->
<!-- Formshell&#45;&gt;ksh -->
<g id="edge23" class="edge">
<title>Formshell&#45;&gt;ksh</title>
<path fill="none" stroke="#000000" d="M258.5117,-509.8541C265.1677,-485.0049 277.1864,-440.1352 285.0415,-410.8096"/>
<polygon fill="#000000" stroke="#000000" points="288.5228,-411.3397 287.7294,-400.7746 281.7612,-409.5285 288.5228,-411.3397"/>
</g>
<!-- csh&#45;&gt;ksh -->
<g id="edge24" class="edge">
<title>csh&#45;&gt;ksh</title>
<path fill="none" stroke="#000000" d="M455.0533,-509.7753C441.783,-489.979 418.5194,-458.3106 392.6512,-436.8 373.498,-420.8732 348.9647,-407.4427 328.9917,-397.9111"/>
<polygon fill="#000000" stroke="#000000" points="330.4287,-394.7195 319.8848,-393.6814 327.48,-401.0682 330.4287,-394.7195"/>
</g>
<!-- tcsh -->
<g id="node20" class="node">
<title>tcsh</title>
<polygon fill="none" stroke="#000000" points="514.6512,-327.6 460.6512,-327.6 460.6512,-291.6 514.6512,-291.6 514.6512,-327.6"/>
<text text-anchor="middle" x="487.6512" y="-303.6" font-family="Times,serif" font-size="20.00" fill="#000000">tcsh</text>
</g>
<!-- csh&#45;&gt;tcsh -->
<g id="edge13" class="edge">
<title>csh&#45;&gt;tcsh</title>
<path fill="none" stroke="#000000" d="M468.4055,-509.755C472.0742,-471.6007 480.5781,-383.1602 484.9496,-337.697"/>
<polygon fill="#000000" stroke="#000000" points="488.4434,-337.9286 485.9166,-327.6395 481.4755,-337.2586 488.4434,-337.9286"/>
</g>
<!-- esh&#45;&gt;ksh -->
<g id="edge25" class="edge">
<title>esh&#45;&gt;ksh</title>
<path fill="none" stroke="#000000" d="M340.5013,-436.8295C332.8638,-428.1418 323.6148,-417.6211 315.2919,-408.1538"/>
<polygon fill="#000000" stroke="#000000" points="317.8055,-405.712 308.5742,-400.5124 312.5482,-410.3338 317.8055,-405.712"/>
</g>
<!-- vsh&#45;&gt;ksh -->
<g id="edge26" class="edge">
<title>vsh&#45;&gt;ksh</title>
<path fill="none" stroke="#000000" d="M221.6237,-436.8295C233.5274,-427.7075 248.0685,-416.5644 260.8863,-406.742"/>
<polygon fill="#000000" stroke="#000000" points="263.2069,-409.3731 269.0154,-400.5124 258.9491,-403.8169 263.2069,-409.3731"/>
</g>
<!-- ksh&#45;i -->
<g id="node21" class="node">
<title>ksh&#45;i</title>
<polygon fill="none" stroke="#000000" points="311.6452,-254.8 255.6572,-254.8 255.6572,-218.8 311.6452,-218.8 311.6452,-254.8"/>
<text text-anchor="middle" x="283.6512" y="-230.8" font-family="Times,serif" font-size="20.00" fill="#000000">ksh&#45;i</text>
</g>
<!-- ksh&#45;&gt;ksh&#45;i -->
<g id="edge29" class="edge">
<title>ksh&#45;&gt;ksh&#45;i</title>
<path fill="none" stroke="#000000" d="M291.5295,-364.2541C289.9935,-339.4049 287.22,-294.5352 285.4073,-265.2096"/>
<polygon fill="#000000" stroke="#000000" points="288.8974,-264.9396 284.787,-255.1746 281.9107,-265.3715 288.8974,-264.9396"/>
</g>
<!-- POSIX -->
<g id="node27" class="node">
<title>POSIX</title>
<polygon fill="none" stroke="#000000" points="449.4216,-36.4 375.8808,-36.4 375.8808,-.4 449.4216,-.4 449.4216,-36.4"/>
<text text-anchor="middle" x="412.6512" y="-12.4" font-family="Times,serif" font-size="20.00" fill="#000000">POSIX</text>
</g>
<!-- System&#45;V&#45;&gt;POSIX -->
<g id="edge27" class="edge">
<title>System&#45;V&#45;&gt;POSIX</title>
<path fill="none" stroke="#000000" d="M416.0024,-364.1345C422.1534,-336.6701 432.6512,-283.0262 432.6512,-236.8 432.6512,-236.8 432.6512,-236.8 432.6512,-164 432.6512,-122.8688 424.7208,-75.8046 418.8475,-46.5889"/>
<polygon fill="#000000" stroke="#000000" points="422.2501,-45.7595 416.7952,-36.6768 415.3954,-47.1788 422.2501,-45.7595"/>
</g>
<!-- v9sh&#45;&gt;tcsh -->
<!-- v9sh&#45;&gt;rc -->
<g id="edge19" class="edge">
<title>v9sh&#45;&gt;rc</title>
<path fill="none" stroke="#000000" d="M151.6512,-291.4541C151.6512,-266.6049 151.6512,-221.7352 151.6512,-192.4096"/>
<polygon fill="#000000" stroke="#000000" points="155.1513,-192.3746 151.6512,-182.3746 148.1513,-192.3747 155.1513,-192.3746"/>
</g>
<!-- KornShell -->
<g id="node22" class="node">
<title>KornShell</title>
<polygon fill="none" stroke="#000000" points="332.8594,-182 234.443,-182 234.443,-146 332.8594,-146 332.8594,-182"/>
<text text-anchor="middle" x="283.6512" y="-158" font-family="Times,serif" font-size="20.00" fill="#000000">KornShell</text>
</g>
<!-- ksh&#45;i&#45;&gt;KornShell -->
<g id="edge30" class="edge">
<title>ksh&#45;i&#45;&gt;KornShell</title>
<path fill="none" stroke="#000000" d="M283.6512,-218.4295C283.6512,-210.5237 283.6512,-201.1 283.6512,-192.3335"/>
<polygon fill="#000000" stroke="#000000" points="287.1513,-192.1124 283.6512,-182.1124 280.1513,-192.1125 287.1513,-192.1124"/>
</g>
<!-- ksh&#45;i&#45;&gt;Bash -->
<g id="edge21" class="edge">
<title>ksh&#45;i&#45;&gt;Bash</title>
<path fill="none" stroke="#000000" d="M257.9137,-218.5605C246.3505,-209.0593 233.5562,-196.4858 225.6512,-182.4 214.8156,-163.0923 210.1355,-138.3552 208.1261,-119.5165"/>
<polygon fill="#000000" stroke="#000000" points="211.6046,-119.1167 207.2437,-109.461 204.6314,-119.7287 211.6046,-119.1167"/>
</g>
<!-- Perl -->
<g id="node23" class="node">
<title>Perl</title>
<polygon fill="none" stroke="#000000" points="404.6512,-182 350.6512,-182 350.6512,-146 404.6512,-146 404.6512,-182"/>
<text text-anchor="middle" x="377.6512" y="-158" font-family="Times,serif" font-size="20.00" fill="#000000">Perl</text>
</g>
<!-- KornShell&#45;&gt;Perl -->
<!-- KornShell&#45;&gt;Bash -->
<g id="edge22" class="edge">
<title>KornShell&#45;&gt;Bash</title>
<path fill="none" stroke="#000000" d="M264.2208,-145.6295C254.8482,-136.7681 243.4584,-125.9995 233.2913,-116.387"/>
<polygon fill="#000000" stroke="#000000" points="235.4796,-113.6393 225.8086,-109.3124 230.6705,-118.7259 235.4796,-113.6393"/>
</g>
<!-- KornShell&#45;&gt;POSIX -->
<g id="edge28" class="edge">
<title>KornShell&#45;&gt;POSIX</title>
<path fill="none" stroke="#000000" d="M299.7283,-145.8541C322.3238,-120.351 363.603,-73.7598 389.5026,-44.5274"/>
<polygon fill="#000000" stroke="#000000" points="392.3597,-46.5806 396.3715,-36.7746 387.1202,-41.9385 392.3597,-46.5806"/>
</g>
<!-- ksh&#45;POSIX -->
<g id="node28" class="node">
<title>ksh&#45;POSIX</title>
<polygon fill="none" stroke="#000000" points="337.8574,-36.4 229.445,-36.4 229.445,-.4 337.8574,-.4 337.8574,-36.4"/>
<text text-anchor="middle" x="283.6512" y="-12.4" font-family="Times,serif" font-size="20.00" fill="#000000">ksh&#45;POSIX</text>
</g>
<!-- KornShell&#45;&gt;ksh&#45;POSIX -->
<g id="edge31" class="edge">
<title>KornShell&#45;&gt;ksh&#45;POSIX</title>
<path fill="none" stroke="#000000" d="M283.6512,-145.8541C283.6512,-121.0049 283.6512,-76.1352 283.6512,-46.8096"/>
<polygon fill="#000000" stroke="#000000" points="287.1513,-46.7746 283.6512,-36.7746 280.1513,-46.7747 287.1513,-46.7746"/>
</g>
<!-- rc&#45;&gt;KornShell -->
<!-- tcl -->
<g id="node25" class="node">
<title>tcl</title>
<polygon fill="none" stroke="#000000" points="514.6512,-109.2 460.6512,-109.2 460.6512,-73.2 514.6512,-73.2 514.6512,-109.2"/>
<text text-anchor="middle" x="487.6512" y="-85.2" font-family="Times,serif" font-size="20.00" fill="#000000">tcl</text>
</g>
<!-- Thompson -->
<g id="node29" class="node">
<title>Thompson</title>
<polygon fill="none" stroke="#000000" points="340.2062,-691.6 239.0962,-691.6 239.0962,-655.6 340.2062,-655.6 340.2062,-691.6"/>
<text text-anchor="middle" x="289.6512" y="-667.6" font-family="Times,serif" font-size="20.00" fill="#000000">Thompson</text>
</g>
<!-- Thompson&#45;&gt;Mashey -->
<g id="edge10" class="edge">
<title>Thompson&#45;&gt;Mashey</title>
<path fill="none" stroke="#000000" d="M265.6787,-655.2295C253.775,-646.1075 239.2339,-634.9644 226.4161,-625.142"/>
<polygon fill="#000000" stroke="#000000" points="228.3533,-622.2169 218.287,-618.9124 224.0955,-627.7731 228.3533,-622.2169"/>
</g>
<!-- Thompson&#45;&gt;Bourne -->
<g id="edge11" class="edge">
<title>Thompson&#45;&gt;Bourne</title>
<path fill="none" stroke="#000000" d="M289.6512,-655.2295C289.6512,-647.3237 289.6512,-637.9 289.6512,-629.1335"/>
<polygon fill="#000000" stroke="#000000" points="293.1513,-628.9124 289.6512,-618.9124 286.1513,-628.9125 293.1513,-628.9124"/>
</g>
<!-- Thompson&#45;&gt;csh -->
<g id="edge12" class="edge">
<title>Thompson&#45;&gt;csh</title>
<path fill="none" stroke="#000000" d="M311.7105,-655.4541C343.1968,-629.5534 401.1245,-581.9022 436.5354,-552.7732"/>
<polygon fill="#000000" stroke="#000000" points="439.0932,-555.2012 444.5926,-546.1454 434.6463,-549.7952 439.0932,-555.2012"/>
</g>
</g>
</svg>
</div>
<blockquote>
<p>图1-2b. 图文件</p>
</blockquote>
<pre><code>digraph shells {
    size=&quot;7,8&quot;;
    node [fontsize=24, shape = plaintext];
    1972 -&gt; 1976 -&gt; 1978 -&gt; 1980 -&gt; 1982 -&gt; 1984 -&gt; 1986 -&gt; 1988
        -&gt; 1990 -&gt; future;
    node [fontsize=20, shape = box];
    { rank = same;  1976 Mashey Bourne; }
    { rank = same;  1978 Formshell csh; }
    { rank = same;  1980 esh vsh; }
    { rank = same;  1982 ksh &quot;System-V&quot;; }
    { rank = same;  1984 v9sh tcsh; }
    { rank = same;  1986 &quot;ksh-i&quot;; }
    { rank = same;  1988 KornShell Perl rc; }
    { rank = same;  1990 tcl Bash; }
    { rank = same;  &quot;future&quot; POSIX &quot;ksh-POSIX&quot;; }
    Thompson -&gt; {Mashey Bourne csh}; csh -&gt; tcsh;
    Bourne -&gt; {ksh esh vsh &quot;System-V&quot; v9sh}; v9sh -&gt; rc;
           {Bourne &quot;ksh-i&quot; KornShell} -&gt; Bash;
    {esh vsh Formshell csh} -&gt; ksh;
    {KornShell &quot;System-V&quot;} -&gt; POSIX;
    ksh -&gt; &quot;ksh-i&quot; -&gt; KornShell -&gt; &quot;ksh-POSIX&quot;;
    Bourne -&gt; Formshell;
    /* ’invisible’ edges to adjust node placement */
    edge [style=invis];
    1984 -&gt; v9sh -&gt; tcsh ; 1988 -&gt; rc -&gt; KornShell;
    Formshell -&gt; csh; KornShell -&gt; Perl;
}
</code></pre>
<h2>2. 最优层级分配</h2>
<p>第一步是为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span></span></span></span>中的每一个节点<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span>根据其边分配一个整数层级<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>λ</mi><mo>(</mo><mi>v</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\lambda(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">λ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>。即对于边集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">E</span></span></span></span>中的每一天边<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi><mo>=</mo><mo>(</mo><mi>v</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo><mo separator="true">,</mo><mi>l</mi><mo>(</mo><mi>e</mi><mo>)</mo><mo>&gt;</mo><mo>=</mo><mi>δ</mi><mo>(</mo><mi>e</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">e=(v,w),l(e)&gt;=\delta(e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">e</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mclose">)</span><span class="mrel">&gt;</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mclose">)</span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi><mo>=</mo><mo>(</mo><mi>v</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">e=(v,w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">e</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span>的长度<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mo>(</mo><mi>e</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">l(e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mclose">)</span></span></span></span>为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>λ</mi><mo>(</mo><mi>w</mi><mo>)</mo><mo>−</mo><mi>λ</mi><mo>(</mo><mi>v</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">(\lambda(w)-\lambda(v))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">λ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mbin">−</span><span class="mord mathit">λ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>，而<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>δ</mi><mo>(</mo><mi>e</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\delta(e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mclose">)</span></span></span></span>表示某个指定的最小长度限制。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>δ</mi><mo>(</mo><mi>e</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\delta(e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mclose">)</span></span></span></span>通常是1，也可以是任意非负整数。由于下述技术上的原因，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>δ</mi><mo>(</mo><mi>e</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\delta(e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mclose">)</span></span></span></span>通常是内部指定的，用户如果想要调整层级分配，也可以从外部指定。在这一步中，每个非空的集合<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo separator="true">,</mo><msub><mi>S</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><msub><mi>S</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>S</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>S</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">S_{max},S_{min},S_0,S_1,...,S_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>会被临时合并成一个节点。另外，环会被忽略，多条边也会被合并为一条，并设置其权重为所有合并边权重之和。为提高性能，那些不从属于上述子集的叶子节点也会被忽略，因为这些叶子节点的层级可以很简单地通过最优层级分配指定。</p>
<h3>2.1 图形去环</h3>
<p>要有一个固定的层级分配，图一定不能存在环。而因为输入的图可能存在环，所以会有一个预处理步骤检测环并且通过反转某个边来去环<sup class="footnote-ref"><a href="#fn8" id="fnref8">[8]</a></sup>。当然，这些边只是在算法内部被反转，最终画出来的图上箭头方向还是原来的方向。深度优先搜索在去环处理上很有用。输入图的边会从任意存在的起始节点或者终止节点按照其&quot;原本&quot;的顺序遍历。在深度优先搜索中，这些边会被分成两个集合：树形边和非树形边<sup class="footnote-ref"><a href="#fn9" id="fnref9">[9]</a></sup>。树为部分节点指定了顺序，根据这些顺序，非树边会被进一步划分为三个子集：交叉边，前向边和后向边。交叉边连接的节点不在树节点中。前向边从树的一个节点连接到其后续节点上。后向边从树的一个节点连接到其祖先节点上。显然，向树形顺序中增加前向边和交叉边不会造成环。而所有后向边都会被转换成前向边，这个处理就破坏了所有的环结构。</p>
<p>显然，反转的边越少越好，最好是一个最小集。不过这里有个难点，要找出这个最小集（反馈弧集问题）是一个NP问题<sup class="footnote-ref"><a href="#fn10" id="fnref10">[10]</a></sup> <sup class="footnote-ref"><a href="#fn11" id="fnref11">[11]</a></sup>。更重要的是，找到一个最小集不一定有助于画图。我们实现了一个启发式算法去反转同时处于多个环中的边。这个算法每次随机取一个不同的强连通分量，对每个强连通分量，通过深度优先遍历计算每条边形成环的次数。成环次数最多的边会被反转。持续这个步骤直到不再存在强连通分量。</p>
<p>实验表明，绝大部分实际应用中产生的有向图，无论有环或无环，通过这个启发式算法都能得到相当自然的边方向。而输入的图通常正具备这种自然的指向。事实上，很多图正是由其他工具进行图搜索时产生。如果反转了不恰当的边，最终的图一定会受到影响。举个例子，程序调用图是可以有环的，而大家往往还是希望顶层的函数能画在图的上方，而不是图中间的某个地方。从算法稳定性上看，深度优先的启发式去环算法最合适不过。相比起把所有环内节点收缩为一个节点，或者把环内节点排布在同一层级，或者复制环中的某个节点等方法而言，这种算法能得到信息更齐备的图。此前多位研究者曾经证明过这个结论<sup class="footnote-ref"><a href="#fn4" id="fnref4:1">[4:1]</a></sup><sup class="footnote-ref"><a href="#fn12" id="fnref12">[12]</a></sup><sup class="footnote-ref"><a href="#fn5" id="fnref5:1">[5:1]</a></sup>。</p>
<p>有个实现的细节是，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">S_{max}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">S_{min}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>表示的节点一定要分配最大和最小层级。要保证这一点，一定要尽可能反转<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">S_{max}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>的连出边和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">S_{min}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>的连入边。并且，对于没有连入边的节点<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span>，创建一条<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>δ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\delta=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">δ</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span>的临时边<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>S</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><mi>v</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(S_{min}, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>，对所有没有连出边的节点<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span>，创建一条<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>δ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\delta = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">δ</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span>的临时边<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>v</mi><mo separator="true">,</mo><msub><mi>S</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">(v, S_{max})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span>。这样一来，对所有的节点<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span>，有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>λ</mi><mo>(</mo><msub><mi>S</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><mo>)</mo><mo>≤</mo><mi>λ</mi><mo>(</mo><mi>v</mi><mo>)</mo><mo>≤</mo><mi>λ</mi><mo>(</mo><msub><mi>S</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\lambda(S_{min})\leq\lambda(v)\leq\lambda(S_{max})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">λ</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mrel">≤</span><span class="mord mathit">λ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mrel">≤</span><span class="mord mathit">λ</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span>。</p>
<h3>2.2 问题定义</h3>
<p>A3原则倾向于画短边。抛开更好的布局效果不谈，短边还可以缩短后续依赖总边长的处理步骤所需的处理时间。因此，找出使得所有有权重的边长度最小的最优的节点层级分配是非常必要的。</p>
<p>而找出最优层级分配可以定义为以下整数规划问题：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>i</mi><msub><mi>n</mi><mrow><mo>(</mo><mi>v</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo></mrow></msub><msub><mo>∑</mo><mrow><mi>m</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>r</mi><mi>E</mi></mrow></msub><mi>ω</mi><mo>(</mo><mi>v</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo><mo>(</mo><mi>λ</mi><mo>(</mo><mi>w</mi><mo>)</mo><mo>−</mo><mi>λ</mi><mo>(</mo><mi>v</mi><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">min_{(v, w)}\sum_{member E} \omega(v, w)(\lambda(w) - \lambda(v))
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.0500050000000005em;"></span><span class="strut bottom" style="height:2.3521180000000004em;vertical-align:-1.3021129999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.2021129999999998em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">m</span><span class="mord mathit">e</span><span class="mord mathit">m</span><span class="mord mathit">b</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.05764em;">E</span></span></span></span><span style="top:-0.000005000000000254801em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol large-op mop">∑</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathit">λ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mbin">−</span><span class="mord mathit">λ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>u</mi><mi>b</mi><mi>j</mi><mi>e</mi><mi>c</mi><mi>t</mi><mspace width="0.22222em"></mspace><mi>t</mi><mi>o</mi><mo>:</mo><mi>λ</mi><mo>(</mo><mi>v</mi><mo>)</mo><mo>−</mo><mi>λ</mi><mo>(</mo><mi>w</mi><mo>)</mo><mo>≥</mo><mi>δ</mi><mo>(</mo><mi>v</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo><mi mathvariant="normal">∀</mi><mo>(</mo><mi>v</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo><mi>m</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>r</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">subject\: to: \lambda(v) - \lambda(w) \geq \delta(v, w) \forall (v, w)member E
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">s</span><span class="mord mathit">u</span><span class="mord mathit">b</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mord mathit">e</span><span class="mord mathit">c</span><span class="mord mathit">t</span><span class="mord mspace mediumspace"></span><span class="mord mathit">t</span><span class="mord mathit">o</span><span class="mrel">:</span><span class="mord mathit">λ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span><span class="mbin">−</span><span class="mord mathit">λ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mrel">≥</span><span class="mord mathit" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mord mathrm">∀</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mord mathit">m</span><span class="mord mathit">e</span><span class="mord mathit">m</span><span class="mord mathit">b</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.05764em;">E</span></span></span></span></span></p>
<p>权重函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ω</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">ω</span></span></span></span>和最小长度函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>δ</mi></mrow><annotation encoding="application/x-tex">\delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">δ</span></span></span></span>会把边集合E分别映射成非负有理数和非负整数集合。</p>
<p>有不少方法可以在多项式时间内解决这个整数规划问题。其中一个是解决等效线性程序，然后把结果在多项式时间内转换成整数解。另一种办法是把最优层级分配问题转换成最小代价最大流问题或者网络流循环问题，这些问题都有多项式时间复杂度的算法（参见<sup class="footnote-ref"><a href="#fn13" id="fnref13">[13]</a></sup>及其索引）。因为约束矩阵完全是幺模的，这个问题应用网络单纯性算法可以在小于多项式时间复杂度内解决。相关技术更详尽的表述可以参考<sup class="footnote-ref"><a href="#fn14" id="fnref14">[14]</a></sup>。</p>
<h3>2.3 网络单纯形</h3>
<p>我们基于网络单纯形<sup class="footnote-ref"><a href="#fn15" id="fnref15">[15]</a></sup>提出解决问题的一个简单算法。这个算法暂时还没有被证明为多项式时间复杂度，不过在实际应用中，这个算法迭代较少，速度也很快。</p>
<p>首先我们给出一些观测结果和定义。一个<em>可行</em>的层级分配必须使得所有的边<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">e</span></span></span></span>满足<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mo>(</mo><mi>e</mi><mo>)</mo><mo>≥</mo><mi>δ</mi><mo>(</mo><mi>e</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">l(e) \geq \delta(e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mclose">)</span><span class="mrel">≥</span><span class="mord mathit" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mclose">)</span></span></span></span>。对于任意的层级分配，无论可行还是不可行，某条边的松弛度被定义为其长度和最小长度之间的差值。因此，对于某种层级分配方案，如果每条边的松弛度都为非负数，那么它是可行的。如果某条边的松弛度为0，那么它是紧凑的。</p>
<p>图的生成树对应着一个层级分配，或者一组层级分配（生成树是底层无根无向图，不一定是有向的树）。选取一个起始节点，配置其层级后，就可以得到一个层级分配。之后，遍历已分配层级节点的相邻节点，根据连线方向分配层级，上游节点层级递减，下游节点层级递增。重复这个过程，直到所有节点都被分配好层级为止。如果最终得到一个可行的层级分配，则这个生成树可行。从结构上看，可行生成树的连线都是紧凑的。</p>
<p>对给定的生成树，我们可以为树的每一条边按照如下规则指定一个切值。如果某条边被移除，那么树会被分成两个连通分量，尾分量包含边的尾节点，头分量包含边的头节点。切值为尾分量所有连向头分量的边，包括这条边本身的权重之和，减去头分量中连向尾分量的所有边的权重之和。</p>
<p>一般情况下（不总是，因为存在退化的情况）负的切值意味着这条边需要尽可能地延长，以使得加权边长度之和尽可能小，最终令头分量到尾分量的边变得紧凑。这和用紧凑边替代生成树中的边从而得到新的可行生成树的做法吻合。显然地，一种最优层级分配方案可以通过可行生成树推导出另一种最优层级分配方案。相对于纯代数范畴而言，在图形领域解决层级分配问题，这些观测是关键。把负切值的树边替换成恰当的非树边，直到所有树边都拥有非负切值为止。为确保这个过程能终止，实现方案理论上应该引入反循环技术，不过笔者实践过程中没有遇到过这个需求。最终得到的生成树可以推导出一个最优层级分配。关于网络单纯形终止问题和结果优化相关的文献可以参见<sup class="footnote-ref"><a href="#fn15" id="fnref15:1">[15:1]</a></sup> <sup class="footnote-ref"><a href="#fn16" id="fnref16">[16]</a></sup> <sup class="footnote-ref"><a href="#fn14" id="fnref14:1">[14:1]</a></sup>。</p>
<p>下图描述了论文中的网络单纯形算法。</p>
<p>图2-1. 网络单纯形</p>
<pre><code>1. procedure rank()
2.     feasible_tree();
3.     while (e = leave_edge()) != nil do
4.         f = enter_edge(e);
5.         exchange(e, f);
6.     end
7.     normalize();
8.     balance();
9. end
</code></pre>
<p>图2-1.中的关注点</p>
<p>2: 函数<code>feasible_tree</code>生成了一个初始化的可行生成树。其具体流程如下所述。网络单纯形算法有一个可行方案开始，并且始终产生可行方案。</p>
<p>3: <code>leave_edge</code>返回一个切值为负的树边，如果没有，则返回nil，后者意味着已经是最优方案。所有负切值的边都会被选中并移除。</p>
<p>4: <code>enter_edge</code>会搜寻一条非树边替代边<code>e</code>。替代过程是先移除边<code>e</code>，这样树会被分为头分量和尾分量。程序会从所有从头分量连向尾分量的边挑选出最紧凑的一条。要保持可行，这一步是必不可少的。</p>
<p>5: 交换边，更新树和边的切值。</p>
<p>7: 最终方案通过把最低层级设置为0进行规范化。</p>
<p>8: 输入和输出边的权重相等，并且有几个不同的可行层级时，把它分配到节点最少的可行层级上。这一步的目的是遵从标准A4，降低拥挤程度，提高图的纵横比。这一步调整并不影响层级分配的效率。基于贪心策略的节点调整效率足够好。全局的层级均衡策略会在接下来的论文中讨论<sup class="footnote-ref"><a href="#fn14" id="fnref14:2">[14:2]</a></sup>。</p>
<p>图2-2. 生成初始化的可行生成树</p>
<pre><code> 1. procedure feasible_tree()
 2.    init_rank();
 3.    while tight_tree() &lt; V do
 4.        e = a non-tree edge incident on the tree
 5.            with a minimal amount of slack;
 6.        delta = slack(e);
 7.        if incident node is e.head then delta = -delta;
 8.        for v in Tree do v.rank = v.rank + delta;
 9.    end
10.    init_cutvalues();
11. end
</code></pre>
<p>图2-2.中的关注点</p>
<p>2: 找出一个初始的可行层级分配。为保持简洁，这里略去<code>init_rank</code>的具体实现。我们的算法是把所有节点存进一个队列中。所有边都已扫描的节点会保留到队列中，否则会从队列中提出来处理。提出来的节点会依据其所有连入边分配一个最小层级，并把其所有连出边标记为已扫描。在最简单的情况下，对所有边有\delt = 1，这时会把图看作偏序集，并把最小元素分配层级0。随后这些元素会被移除，新的最小元素集合则分配层级1，依此类推。</p>
<p>3: 函数<code>tight_tree</code>生成包含某些固定节点的紧凑边的最大生成树，并返回树的节点数。这里的最大生成树就是由固定节点通过紧凑边在底层无向图能到达的所有节点组成子图的生成树。所有这些书都具有相同的节点数。</p>
<p>4-8: 为树相邻的一个非树节点找到一条边，并调节树节点的层级，使得这条边紧凑。因为这被选择的边的松弛度一定是最小的，因此得到的层级分配仍然是可行的。从而在每次迭代后，最大紧凑树都会最少多得一个节点，从而算法最终能得到可行生成树。这里的算法实际上是Sugiyama等人提出的<sup class="footnote-ref"><a href="#fn5" id="fnref5:2">[5:2]</a></sup>。</p>
<p>10: <code>init_cutvalues</code>函数计算树边的切值。对每一条树边，计算切值时把节点分为头分量和尾分量，然后计算所有头和尾分别在不同分量内的边权重之和，其中，从头分量连向尾分量的边的权重设置为负值。</p>
<p>图2-3. 找到最优可行树</p>
<figure><img src="./a-technique-for-drawing-directed-graphs/figure-2-3.png" alt="fiture-2-3"></figure>
<p>图2-3中展示了网络简单形算法的一个简单例子。图中虚线所示是非树边，所有边权重为1。a图展示的是分配了初始层级的图，其边的切值如图所示。举个例子，边<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>g</mi><mo separator="true">,</mo><mi>h</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(g, h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mpunct">,</span><span class="mord mathit">h</span><span class="mclose">)</span></span></span></span>的切值为-1，表示边<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>g</mi><mo separator="true">,</mo><mi>h</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(g, h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mpunct">,</span><span class="mord mathit">h</span><span class="mclose">)</span></span></span></span>（从尾分量连向头分量）的权重减去边<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>a</mi><mo separator="true">,</mo><mi>e</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(a, e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">a</span><span class="mpunct">,</span><span class="mord mathit">e</span><span class="mclose">)</span></span></span></span>和边<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>a</mi><mo separator="true">,</mo><mi>f</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(a, f)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">a</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mclose">)</span></span></span></span>（从头分量连向尾分量）的权重之和。b图中，负切值边<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>g</mi><mo separator="true">,</mo><mi>h</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(g, h)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mpunct">,</span><span class="mord mathit">h</span><span class="mclose">)</span></span></span></span>被非树边<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>a</mi><mo separator="true">,</mo><mi>e</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(a, e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">a</span><span class="mpunct">,</span><span class="mord mathit">e</span><span class="mclose">)</span></span></span></span>替代，并标注了新所有树边的切值。此时所有边的切值均为正值，所以这个方案是最优的，算法结束。</p>
<h3>2.4 实现细节</h3>
<p>各种版本的网络简单形算法已经被深入研究过，文献里的研究成果<sup class="footnote-ref"><a href="#fn15" id="fnref15:2">[15:2]</a></sup>可以作为实现的参考。不过我们还是觉得有必要为预期的算法实现者指出几个实现细节。这几个优化细节在这一步很有用，而到第4节我们应对更大的图而再次用网络简单形算法的时候，会变得至关重要。</p>
<p>实现网络简单形算法时，计算初始的可行树和切值往往会花费相当一部分的成本。对于实际的很多图而言，这个初始化方案已经接近最优，只需要几步迭代就能得到最终结果。在简单的实现里，初始的切值可以通过简单遍历边，移除每条边，对每个节点进行头分量和尾分量的分类，计算结果这几个步骤完成，时间复杂度为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><mi>V</mi><mi>E</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">O(VE)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mclose">)</span></span></span></span>。</p>
<p>为降低计算成本，我们注意到，如果可行树节点遍历是由叶子节点开始向上的，那么可以通过边局部的信息来计算切值。对于连接叶子节点的边，因为切分后头分量或者尾分量中只有一个节点，切值的计算是非常简单的。现在假设已知某个节点所连接的除了一条边以外，所有边的切值，那么剩余那条边的切值就等于已知切值之和加上节点所连非树边的权重。</p>
<p>图2-4中，两条树边已知切值，和第三条边共同连接到一个节点上，各自方向如图示。其他场景的处理类似。我们假设边<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>u</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(u, w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">u</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>v</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(v, w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span>的切值已知。以大写字母标记的边是非树边，其方向、头尾所属联通量如图示。边<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>u</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(u, w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">u</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>v</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(v, w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span>的切值分别为：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mo>(</mo><mi>u</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo></mrow></msub><mo>=</mo><mi>ω</mi><mo>(</mo><mi>u</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo><mo>+</mo><mi>A</mi><mo>+</mo><mi>C</mi><mo>+</mo><mi>F</mi><mo>−</mo><mi>B</mi><mo>−</mo><mi>E</mi><mo>−</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">C_{(u, w)} = \omega(u, w) + A + C + F - B - E - D
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.1052em;vertical-align:-0.3551999999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mopen">(</span><span class="mord mathit">u</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mopen">(</span><span class="mord mathit">u</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit">A</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.02778em;">D</span></span></span></span></span></p>
<p>以及</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mo>(</mo><mi>v</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo></mrow></msub><mo>=</mo><mi>ω</mi><mo>(</mo><mi>v</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo><mo>+</mo><mi>L</mi><mo>+</mo><mi>I</mi><mo>+</mo><mi>D</mi><mo>−</mo><mi>K</mi><mo>−</mo><mi>J</mi><mo>−</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">C_{(v, w)} = \omega(v, w) + L + I + D - K - J - C
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.1052em;vertical-align:-0.3551999999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit">L</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.07153em;">K</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span></span></span></p>
<p>此时，边<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>w</mi><mo separator="true">,</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(w, x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span>的切值为：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtable><mtr><mtd><mrow><msub><mi>C</mi><mrow><mo>(</mo><mi>w</mi><mo separator="true">,</mo><mi>x</mi><mo>)</mo></mrow></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>ω</mi><mo>(</mo><mi>w</mi><mo separator="true">,</mo><mi>x</mi><mo>)</mo><mo>+</mo><mi>G</mi><mo>−</mo><mi>H</mi><mo>+</mo><mi>A</mi><mo>−</mo><mi>B</mi><mo>+</mo><mi>L</mi><mo>−</mo><mi>K</mi></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>ω</mi><mo>(</mo><mi>w</mi><mo separator="true">,</mo><mi>x</mi><mo>)</mo><mo>+</mo><mi>G</mi><mo>−</mo><mi>H</mi><mo>+</mo><mo>(</mo><msub><mi>C</mi><mrow><mo>(</mo><mi>u</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo></mrow></msub><mo>−</mo><mi>ω</mi><mo>(</mo><mi>u</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo><mo>−</mo><mi>C</mi><mo>−</mo><mi>F</mi><mo>+</mo><mi>E</mi><mo>+</mo><mi>D</mi><mo>)</mo><mo>+</mo><mo>(</mo><msub><mi>C</mi><mrow><mo>(</mo><mi>v</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo></mrow></msub><mo>−</mo><mi>ω</mi><mo>(</mo><mi>v</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo><mo>−</mo><mi>I</mi><mo>−</mo><mi>D</mi><mo>+</mo><mi>J</mi><mo>+</mo><mi>C</mi><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>ω</mi><mo>(</mo><mi>w</mi><mo separator="true">,</mo><mi>x</mi><mo>)</mo><mo>+</mo><mi>G</mi><mo>−</mo><mi>H</mi><mo>+</mo><msub><mi>C</mi><mrow><mo>(</mo><mi>u</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo></mrow></msub><mo>−</mo><mi>ω</mi><mo>(</mo><mi>u</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo><mo>+</mo><msub><mi>C</mi><mrow><mo>(</mo><mi>v</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo></mrow></msub><mo>−</mo><mi>ω</mi><mo>(</mo><mi>v</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo><mo>−</mo><mi>F</mi><mo>+</mo><mi>E</mi><mo>−</mo><mi>I</mi><mo>+</mo><mi>J</mi></mrow></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{aligned}
C_{(w, x)} &amp; = \omega(w, x) + G - H + A - B + L - K \\
           &amp; = \omega(w, x) + G - H + (C_{(u, w)} - \omega(u, w) - C -F + E + D) + (C_{(v, w)} - \omega(v, w) - I -D + J + C) \\
           &amp; = \omega(w, x) + G - H + C_{(u, w)} - \omega(u, w) + C_{(v, w)} - \omega(v, w) - F + E - I + J
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.05em;"></span><span class="strut bottom" style="height:3.6000000000000005em;vertical-align:-1.5500000000000007em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.2099999999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span><span style="top:-0.00999999999999951em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span style="top:1.1900000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.2099999999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit">G</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mbin">+</span><span class="mord mathit">A</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mbin">+</span><span class="mord mathit">L</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.07153em;">K</span></span></span><span style="top:-0.00999999999999951em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit">G</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mbin">+</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mopen">(</span><span class="mord mathit">u</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mopen">(</span><span class="mord mathit">u</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mclose">)</span><span class="mbin">+</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.02778em;">D</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span><span style="top:1.1900000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit">G</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mopen">(</span><span class="mord mathit">u</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mopen">(</span><span class="mord mathit">u</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="vlist"><span style="top:0.18019999999999992em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mbin">−</span><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.09618em;">J</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></span></span></p>
<p>最终的计算表达式仅仅涉及局部的边信息和已知边的切值。因此通过逐步计算切值，我们能保证每条边仅仅会被扫描两次，从而大幅度降低了计算出时切值的时间。</p>
<p>图2-4. 逐步计算切值</p>
<figure><img src="./a-technique-for-drawing-directed-graphs/figure-2-4.png" alt="fiture-2-4"></figure>
<p>另一个有价值的优化是<sup class="footnote-ref"><a href="#fn15" id="fnref15:3">[15:3]</a></sup>中描述过的技术，从某个固定根节点<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>v</mi><mrow><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">v_{root}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">o</span><span class="mord mathit">o</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>开始执行后序遍历，并且对每个节点v，用<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>i</mi><mi>m</mi><mo>(</mo><mi>v</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">lim(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>表示其后序遍历数，用<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>o</mi><mi>w</mi><mo>(</mo><mi>v</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">low(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>表示其子孙节点中的最小后序遍历数，用<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mi>a</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>t</mi><mo>(</mo><mi>v</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">parent(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit">n</span><span class="mord mathit">t</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>表示每个节点的父节点后序遍历数（见图2-5）。</p>
<p>图2-5. 后序遍历，节点上的标签为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>l</mi><mi>o</mi><mi>w</mi><mo separator="true">,</mo><mi>l</mi><mi>i</mi><mi>m</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(low, lim)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mclose">)</span></span></span></span></p>
<figure><img src="./a-technique-for-drawing-directed-graphs/figure-2-5.png" alt="fiture-2-5"></figure>
<p>这个算法提供了一种廉价的方式来检验某个节点是否在树边的头分量或者尾分量上，从而可以简单求证某个非树边是否头尾分属头分量和尾分量。举个例子，如果<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi><mo>=</mo><mo>(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">e = (u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">e</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathit">u</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>是一个树边，而<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>v</mi><mrow><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">v_{root}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">o</span><span class="mord mathit">o</span><span class="mord mathit">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>在边的头分量中（也就是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>i</mi><mi>m</mi><mo>(</mo><mi>u</mi><mo>)</mo><mo>&lt;</mo><mi>l</mi><mi>i</mi><mi>m</mi><mo>(</mo><mi>v</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">lim(u) &lt; lim(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mopen">(</span><span class="mord mathit">u</span><span class="mclose">)</span><span class="mrel">&lt;</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>），那么当且仅当<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>o</mi><mi>w</mi><mo>(</mo><mi>u</mi><mo>)</mo><mo>≤</mo><mi>l</mi><mi>i</mi><mi>m</mi><mo>(</mo><mi>w</mi><mo>)</mo><mo>≤</mo><mi>l</mi><mi>i</mi><mi>m</mi><mo>(</mo><mi>u</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">low(u) \leq lim(w) \leq lim(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord mathit">u</span><span class="mclose">)</span><span class="mrel">≤</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mrel">≤</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mopen">(</span><span class="mord mathit">u</span><span class="mclose">)</span></span></span></span>时，节点w在尾分量中。这些数字也可以用在每次网络简单形迭代中高效地进行生成树更新。假设当前处理的边是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>=</mo><mo>(</mo><mi>w</mi><mo separator="true">,</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">f = (w, x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span>，那么需要更新切值的边都是生成树里和w和x相连路径上的边。这个路径可以通过回溯w和x的父节点，直到找到最近的共同祖先节点来确定，举个例子，就是第一个符合<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>o</mi><mi>w</mi><mo>(</mo><mi>l</mi><mo>)</mo><mo>≤</mo><mi>l</mi><mi>i</mi><mi>m</mi><mo>(</mo><mi>w</mi><mo>)</mo><mo separator="true">,</mo><mi>l</mi><mi>i</mi><mi>m</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>≤</mo><mi>l</mi><mi>i</mi><mi>m</mi><mo>(</mo><mi>l</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">low(l) \leq lim(w), lim(x) \leq lim(l)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mclose">)</span><span class="mrel">≤</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">≤</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">i</span><span class="mord mathit">m</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mclose">)</span></span></span></span>的节点。当然，这些后序遍历参数在交换树连线的时候需要再次更新，不过都仅限于节点l的子节点下。</p>
<p>网络简单形算法的性能对于替代负切值边的选择也很敏感。经过实际观测，我们发现对所有树边进行循环搜索的效率会比每次对树边列表的从头开始搜索更高一些。</p>
<h2>3. 层级内顶点排序</h2>
<p>分配完层级之后，跨越多个层级的边会被替换成由多条连接临时节点或者“虚拟节点”的单位长度的边。虚拟节点被安插到中间层级上，使得整张图中所有边都只连接相邻层级的节点。这个步骤会忽略自连边，重复边也像上一步一样被合并。</p>
<p>每层中的顶点顺序决定了布局的边交叉情况，因此一个好的层级内顶点顺序应该要尽量少产生交叉边。因为对于分层图布局，即便只有两层，要使边交叉最小化，这是一个NP完全问题。因此这里适合采用启发式算法<sup class="footnote-ref"><a href="#fn10" id="fnref10:1">[10:1]</a></sup>。</p>
<p>有几个减少分层图中边交叉的启发式算法都基于Warfield<sup class="footnote-ref"><a href="#fn3" id="fnref3:1">[3:1]</a></sup>提出的下面这个方案。首先给出每一层节点的初始化顺序。然后执行一系列迭代尝试改进这个顺序。每次迭代从第一层遍历到最后一层，反之亦可。当访问某一层时，这一层每个顶点都会根据其关联的上一层顶点的位置分配一个权重。然后这一层的顶点会根据这个权重进行排序。</p>
<p>比较常用的两个顶点权重分配算法分别是重心法（barycenter function）<sup class="footnote-ref"><a href="#fn5" id="fnref5:3">[5:3]</a></sup>和中位数法（median function）<sup class="footnote-ref"><a href="#fn17" id="fnref17">[17]</a></sup>。令v为顶点，P为其相邻层级上相连顶点的位置列表。这里的位置指的是顶点在其层级上的顺序序号。重心法定义v的权重为P中元素的平均值。中位数法定义v的权重为P中元素的中位数。当P的元素个数为偶数时，中位数有两个。这就导致中位数法会有两个版本，一个版本总是采用左中位数，另一个版本总是采用右中位数。中位数法的表现始终比重心法要好，并且有轻微的理论优势。因为Eades和Wormald<sup class="footnote-ref"><a href="#fn17" id="fnref17:1">[17:1]</a></sup>研究表明，对两层的图而言，采用中位数的布局边交叉数最多不会超过最小边交叉数的3倍。而重心法并没有类似的研究结果。</p>
<p>我们的节点排序方法中位数法的改进版本，主要做了两个方面的优化。第一个是当有两个中位数的时候，我们倾向采用偏向更紧凑节点排布的内插值。第二个是采用一个启发式算法进一步减少排序后的明显边交叉，从而把指定排序转化成相对于顶点交换而言局部最优的排序。这个方法比起原方法大约减少了20-50%的边交叉数。更详细的统计数据读者可以参考<sup class="footnote-ref"><a href="#fn1" id="fnref1:2">[1:2]</a></sup>。</p>
<p>图3-1.展示了顶点排序算法。</p>
<pre><code> 1. procedure ordering()
 2.     order = init_order();
 3.     best = order;
 4.     for i = 0 to Max_iterations do
 5.         wmedian(order,i);
 6.         transpose(order);
 7.         if crossing(order) &lt; crossing(best) then
 8.             best = order;
 9.     end
10.     return best;
11. end
</code></pre>
<p>图3-1. 顶点排序算法</p>
<p>图3-1中的关注点</p>
<p>2: <code>init_order</code>初始化每个层级中的节点排序。这一步可以从最小层级的顶点开始，通过深度优先或者广度优先遍历来完成。遍历过程中，顶点通过由左往右的顺序来指定位置。这个策略保证了树图的初始化排序是没有边交叉的。这个策略很重要，因为树图产生的边交叉明显是可以避免的“失误”。</p>
<p>4-9: <code>Max_iterations</code>是最大迭代次数。我们设置这个常量为24。在每次迭代中，如果边交叉减少了，新的排序方案会被保存。在实际实现时，有人可能倾向采用自适应的策略，即只要过去几次迭代优化了几个百分点时，就继续迭代。<code>wmedian</code>通过启发式加权中位数法重新排序各层的节点。<code>transpose</code>会在能减少边交叉的时候交换同一层的两个相邻顶点。这些函数接下来会进一步论述。</p>
<h2>4. 节点坐标</h2>
<p>第三部是计算节点坐标。之前的论文把计算节点坐标作为计算质心或者中心的后置步骤，为了布局的美观做一些局部的调整。我们将节点的位置作为一个独立的明确的问题，但是要为了更好的布局和未来的扩展性让步，例如顶点的排序是用拓扑算法还是几何算法。
X和Y坐标计算分两步进行。第一步是根据已经计算好的排序顺序，给所有节点分配X坐标(包括虚拟节点)。第二步是根据同样的排序顺序分配Y坐标。Y坐标的分配必须在节点的盒模型外维持最小的间隔<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mi>a</mi><mi>n</mi><mi>k</mi><mi>s</mi><mi>e</mi><mi>p</mi><mo>(</mo><mi>G</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">ranksep(G)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">n</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mord mathit">s</span><span class="mord mathit">e</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">G</span><span class="mclose">)</span></span></span></span>。当然，也可以调大邻近节点的间隔，增加邻近边的斜率，让整个图更具可读性。因为Y坐标的步骤很明确，所以这一小节的剩余部分会介绍如何计算X坐标。
根据之前提到过的审美原则，我们认为短而直的边比长而弯曲的边更好。X坐标计算存在如下的整数优化问题。</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>i</mi><mi>n</mi><msub><mo>∑</mo><mrow><mi>e</mi><mo>=</mo><mo>(</mo><mi>v</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo></mrow></msub><mi mathvariant="normal">Ω</mi><mo>(</mo><mi>e</mi><mo>)</mo><mi>ω</mi><mo>(</mo><mi>e</mi><mo>)</mo><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>w</mi></msub><mo>−</mo><msub><mi>x</mi><mi>v</mi></msub><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">min\sum_{e=(v,w)} \Omega(e) \omega(e) |x_w-x_v|
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.050005em;"></span><span class="strut bottom" style="height:2.5660100000000003em;vertical-align:-1.516005em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mop op-limits"><span class="vlist"><span style="top:1.241005em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">e</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span><span class="op-symbol large-op mop">∑</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathrm">Ω</span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mclose">)</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mclose">)</span><span class="mord mathrm">∣</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathrm">∣</span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>u</mi><mi>b</mi><mi>j</mi><mi>e</mi><mi>c</mi><mi>t</mi><mspace width="0.22222em"></mspace><mi>t</mi><mi>o</mi><mo>:</mo><msub><mi>x</mi><mi>b</mi></msub><mo>−</mo><msub><mi>x</mi><mi>a</mi></msub><mo>&gt;</mo><mo>=</mo><mi>ρ</mi><mo>(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">subject\: to: x_b-x_a&gt;=\rho(a,b)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit">s</span><span class="mord mathit">u</span><span class="mord mathit">b</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mord mathit">e</span><span class="mord mathit">c</span><span class="mord mathit">t</span><span class="mord mspace mediumspace"></span><span class="mord mathit">t</span><span class="mord mathit">o</span><span class="mrel">:</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">b</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">a</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">&gt;</span><span class="mrel">=</span><span class="mord mathit">ρ</span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mpunct">,</span><span class="mord mathit">b</span><span class="mclose">)</span></span></span></span></span></p>
<p>其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">a</span></span></span></span>是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">b</span></span></span></span>左边的邻近节点，有相同的排序值，并且<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ρ</mi><mo>(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo>)</mo><mo>=</mo><mo>(</mo><mi>x</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>(</mo><mi>a</mi><mo>)</mo><mo>+</mo><mi>x</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>(</mo><mi>b</mi><mo>)</mo><mo>)</mo><mi mathvariant="normal">/</mi><mn>2</mn><mo>+</mo><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>s</mi><mi>e</mi><mi>p</mi><mo>(</mo><mi>G</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\rho(a,b)= (xsize(a)+xsize(b))/2 + nodesep(G)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">ρ</span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mpunct">,</span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mord mathit">e</span><span class="mopen">(</span><span class="mord mathit">a</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit">x</span><span class="mord mathit">s</span><span class="mord mathit">i</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mord mathit">e</span><span class="mopen">(</span><span class="mord mathit">b</span><span class="mclose">)</span><span class="mclose">)</span><span class="mord mathrm">/</span><span class="mord mathrm">2</span><span class="mbin">+</span><span class="mord mathit">n</span><span class="mord mathit">o</span><span class="mord mathit">d</span><span class="mord mathit">e</span><span class="mord mathit">s</span><span class="mord mathit">e</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">G</span><span class="mclose">)</span></span></span></span>
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Ω</mi><mo>(</mo><mi>e</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\Omega(e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">Ω</span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mclose">)</span></span></span></span>是一个与输入的边权重<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ω</mi><mo>(</mo><mi>e</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\omega(e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mclose">)</span></span></span></span>不同的内部值，用于使计算出的边更倾向于长直线。由于两个邻近节点，相同排序值的边总是直线，减少节点之间的水平间距显得更加重要。因此，连线会在竖直方向上对齐，并且是直线。如果不这样做会导致一个&quot;面条效应&quot;，边会有许多不同的斜率。相应的，我们可以根据末尾的顶点将边分为三种不同的类型: （1）都是真实节点; (2)一个真实节点和一个虚拟节点;(3)都是虚拟节点。如果<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">e</span></span></span></span>,<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span></span></span></span>,<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span></span>分别是对应三种类型的边，那么<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Ω</mi><mo>(</mo><mi>e</mi><mo>)</mo><mo>&lt;</mo><mo>=</mo><mi mathvariant="normal">Ω</mi><mo>(</mo><mi>f</mi><mo>)</mo><mo>&lt;</mo><mo>=</mo><mi mathvariant="normal">Ω</mi><mo>(</mo><mi>g</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\Omega(e)&lt;=\Omega(f)&lt;=\Omega(g)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">Ω</span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mclose">)</span><span class="mrel">&lt;</span><span class="mrel">=</span><span class="mord mathrm">Ω</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mclose">)</span><span class="mrel">&lt;</span><span class="mrel">=</span><span class="mord mathrm">Ω</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mclose">)</span></span></span></span>。我们实现的方式采用的值是1, 2和8。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mi>h</mi><mi>o</mi></mrow><annotation encoding="application/x-tex">rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">h</span><span class="mord mathit">o</span></span></span></span>是计算相邻两个相同排序值的节点的中心之间最小间隔的函数。</p>
<p>现在已有将这个问题转化为一个线性程序的标准技术，添加辅助变量和不等量(inquality)来消除绝对值[Ch]。由于得到的限制完全是幺模的，用单纯性方法解出这个线性程序就为解决这个线性问题提供了思路，编程简单，给出的布局也符合审美。不幸的是这种变换把单纯形矩阵的大小从<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>V</mi><mi>E</mi></mrow><annotation encoding="application/x-tex">VE</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mord mathit" style="margin-right:0.05764em;">E</span></span></span></span>增加到了<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>2</mn><mi>V</mi><mi>E</mi><mo>+</mo><msup><mi>E</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">2VE+E^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathit" style="margin-right:0.22222em;">V</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>.画少量的节点和连线的时候仅需数秒，但是大型的图会需要更久，甚至内存会成为一个局限。因此这并不是一个最优的布局方式。</p>
<h3>4.1 启发式方法</h3>
<p>这种方法用启发式程序替换现行程序来计算X坐标。启发式方法寻找一个“好”的初始位置，然后扫描上述的排序算法得到的排序值的节点，迭代的尝试优化这个位置。可以用以下为代表表示启发式方法。</p>
<blockquote>
<p>图4-1. 给顶点分配X坐标</p>
</blockquote>
<pre><code>1.  procedure xcordinate()
2.      xcoord = init_xcord();
3.      xbest = xcoord;
4.      for i = 0 to Max_iterations do
5.      medianpos(i,xcoord);
6.      minedge(i,xcoord);
7.      minpath(i,xcoord);
8.      packcut(i,xcoord);
9.      if xlength(xcoord) &lt; xlength(xbest) then
10.         xbest = xcoord;
11.     end
12.     return xbest;
13. end
</code></pre>
<p>2: 按照如下方式计算初始坐标集。对于每一个排序值，给最左边的节点分配坐标0。给其余每一个节点分配的坐标与前一个节点之间只满足最小间隔。因此，每个相同排序值的节点初始时都尽量靠左。</p>
<p>4-12: 在每个迭代，应用一系列的启发式方法优化坐标分配。如果当前迭代的结果优于之前的分配方案就保存这个方案。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>t</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">xlength</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">e</span><span class="mord mathit">n</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">t</span><span class="mord mathit">h</span></span></span></span>是实现以上优化问题的目标函数。在我们的实现中，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mi>a</mi><msub><mi>x</mi><mi>i</mi></msub><mi>t</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">Max_iteration</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mord mathit">a</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord mathit">t</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">i</span><span class="mord mathit">o</span><span class="mord mathit">n</span></span></span></span>的值为8.</p>
<p>5: 中位数启发(median heuristic)基于当<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span>的值为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>的中位数的时候，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">∣</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mn>0</mn></msub><mo fence="true">∣</mo></mrow><mo>+</mo><mrow><mo fence="true">∣</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo fence="true">∣</mo></mrow><mo>+</mo><mo>⋯</mo><mo>+</mo><mrow><mo fence="true">∣</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="true">∣</mo></mrow></mrow><annotation encoding="application/x-tex">\left | x -x_0\right |+\left |x-x_1  \right | + \cdots + \left | x -x_i\right |</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">∣</span><span class="mord mathit">x</span><span class="mbin">−</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">∣</span></span><span class="mbin">+</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">∣</span><span class="mord mathit">x</span><span class="mbin">−</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">∣</span></span><span class="mbin">+</span><span class="minner">⋯</span><span class="mbin">+</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">∣</span><span class="mord mathit">x</span><span class="mbin">−</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">∣</span></span></span></span></span>的值最小。这种启发方法按照每个节点的进和出的边的权重和给每个节点都分配一个最大和最小的优先级。在向下迭代时，节点根据最小优先级进行处理。将节点放到向下相邻节点的中位数位置，给更高优先级的节点和还没有分配坐标的节点让出空间。如果有两个中位数，用平均值对称优化(A4)。向上迭代也是相同的处理方式。</p>
<p>6: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>e</mi><mi>d</mi><mi>g</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">minedge</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mathit">e</span><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">e</span></span></span></span>与<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>a</mi><mi>n</mi><mi>p</mi><mi>o</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">medianpos</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">m</span><span class="mord mathit">e</span><span class="mord mathit">d</span><span class="mord mathit">i</span><span class="mord mathit">a</span><span class="mord mathit">n</span><span class="mord mathit">p</span><span class="mord mathit">o</span><span class="mord mathit">s</span></span></span></span>类似，但是只考虑连接两个真实节点之间的边。将边垂直放置，尽量靠近邻近边终端的节点的中位数。</p>
<p>7: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">minnode</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mathit">n</span><span class="mord mathit">o</span><span class="mord mathit">d</span><span class="mord mathit">e</span></span></span></span>用一个队列，每次仅优化一个节点。一开始所有节点入队列。当一个节点从队列中移除时，将它尽量分配到离所有上层和下层节点的中位数最近的位置，同时也满足最小间隔函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ρ</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">ρ</span></span></span></span>.如果节点的位置改变了，不在队列中的邻近节点也需要入队。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">minnode</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mathit">n</span><span class="mord mathit">o</span><span class="mord mathit">d</span><span class="mord mathit">e</span></span></span></span>在得到局部最小时终止。</p>
<p>8: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>i</mi><mi>n</mi><mi>p</mi><mi>a</mi><mi>t</mi><mi>h</mi></mrow><annotation encoding="application/x-tex">minpath</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mord mathit">p</span><span class="mord mathit">a</span><span class="mord mathit">t</span><span class="mord mathit">h</span></span></span></span>逐个找到可能有相同X坐标的子链来优化虚拟节点的连线。</p>
<p>9: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mi>a</mi><mi>c</mi><mi>k</mi><mi>c</mi><mi>u</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">packcut</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mord mathit">a</span><span class="mord mathit">c</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">t</span></span></span></span>从左到右扫描布局，寻找能压缩的区块。对于每个节点，如果所有在其右边的节点如果在不违背位置约束的情况下能被替换到左边，就进行替换。有一种算法用来处理这个操作，维护一个节点数组，根据X坐标排序。虽然这个算法在最坏情况下是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>o</mi><mo>(</mo><msup><mi>n</mi><mn>2</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">o(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">o</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span>的,但是在实际情况下表现很好。因为每个可能的裁剪都只需要搜索受影响的邻近节点。</p>
<p>这些启发式方法可以让我们快速得到很好的布局，但是他们实现很负责，而且有时候结果明显的不完美。进一步计算就比较困难，因为这些方法会有互相干扰。</p>
<h3>4.2 最优节点放置</h3>
<p>我们意识到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mi>a</mi><mi>c</mi><mi>k</mi><mi>c</mi><mi>u</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">packcut</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mord mathit">a</span><span class="mord mathit">c</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mord mathit">c</span><span class="mord mathit">u</span><span class="mord mathit">t</span></span></span></span>并不能找到所有可以压缩的子图来优化布局。我们考虑使用一个更加通用的启发式方法来查找字数并且进行转换。然后，我们发现这与网络单纯形算法移动整个子图查找最优的排序分配非常相似(具体可见第2节)。这意味着我们可以应用网络单纯形算法，用X坐标作为排行，找到最优的节点坐标。</p>
<p>这个方法包括构造如图4-2所示的辅助图。这种转换是上面提过到的图像相似性的代数转换，用于从优化问题中去除绝对值。辅助图的节点<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mi>G</mi></mrow><mrow><mi mathvariant="normal">′</mi></mrow></msup></mrow><annotation encoding="application/x-tex">{G}&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathit">G</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>是原图<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span></span></span></span>。在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span></span></span></span>中的每一条边<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">e</span></span></span></span>,就有一个新节点<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>n</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">n_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">e</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>。在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mi>G</mi></mrow><mrow><mi mathvariant="normal">′</mi></mrow></msup></mrow><annotation encoding="application/x-tex">{G}&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathit">G</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>中有两种边。一种对原始的边的代价进行编码(encodes the cost of the original edges)。在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span></span></span></span>中的每一条边<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi><mo>=</mo><mo>(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">e=(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">e</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathit">u</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>会被替换成两条边<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>n</mi><mi>e</mi></msub><mo separator="true">,</mo><mi>u</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(n_e, u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">e</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord mathit">u</span><span class="mclose">)</span></span></span></span>以及<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msub><mi>n</mi><mi>e</mi></msub><mo separator="true">,</mo><mi>u</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(n_e, u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">e</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord mathit">u</span><span class="mclose">)</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>δ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\delta = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">δ</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span>,<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ω</mi><mo>=</mo><mi>ω</mi><mo>(</mo><mi>e</mi><mo>)</mo><mi mathvariant="normal">Ω</mi><mo>(</mo><mi>e</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\omega = \omega(e)\Omega(e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mclose">)</span><span class="mord mathrm">Ω</span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mclose">)</span></span></span></span>。另一种边将同一序列的节点分开。如果<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span>是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ω</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">ω</span></span></span></span>的左邻居，那么<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mi>G</mi></mrow><mrow><mi mathvariant="normal">′</mi></mrow></msup></mrow><annotation encoding="application/x-tex">{G}&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathit">G</span></span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>就有一条边f=e(_v_,_w),<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>δ</mi><mo>(</mo><mi>f</mi><mo>)</mo><mo>=</mo><mi>ρ</mi><mo>(</mo><mi>v</mi><mo separator="true">,</mo><mi>w</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">\delta(f) = \rho(v, w)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">ρ</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="mclose">)</span></span></span></span>,<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ω</mi><mo>(</mo><mi>f</mi><mo>)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\omega(f) = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span>.这条边将相对的节点充分的隔开，并且不影响整个布局的开销。</p>
<blockquote>
<p>图4-2</p>
</blockquote>
<figure><img src="./a-technique-for-drawing-directed-graphs/figure-4-2.png" alt="Figure 4-2"></figure>
<p>我们现在可以考虑<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>G</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup></mrow><annotation encoding="application/x-tex">G&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">G</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>的层级分配问题了。这个问题可以用网络单纯形方法解决。任何解决<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span></span></span></span>的定位问题的方式与<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>G</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup></mrow><annotation encoding="application/x-tex">G&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">G</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>的层级分配问题是统一的。根据图4-2的方式给每个<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>n</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">n_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">n</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">e</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>分配<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>i</mi><mi>n</mi><mo>(</mo><msub><mi>x</mi><mi>u</mi></msub><mo separator="true">,</mo><msub><mi>x</mi><mi>v</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">min(x_u, x_v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span></span></span></span>的值，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">x_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">x_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span></span></span></span>中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">u</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span>的X坐标。相反的，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>G</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup></mrow><annotation encoding="application/x-tex">G&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">G</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>里的任何层级分配都会催生一个<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span></span></span></span>中的有效位置。另外，在最优的层级分配中，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>e</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">e_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>或<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>e</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">e_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>中必须有一个长度为0，其他几个的长度为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">∣</mo><msub><mi>x</mi><mi>u</mi></msub><mo>−</mo><msub><mi>x</mi><mi>v</mi></msub><mo fence="true">∣</mo></mrow></mrow><annotation encoding="application/x-tex">\left | x_u -x_v\right|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">∣</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">∣</span></span></span></span></span>.这说明了<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span></span></span></span>中一条边<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">u</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>的开销等于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>G</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup></mrow><annotation encoding="application/x-tex">G&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">G</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>中的两条边<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>e</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">e_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>e</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">e_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>的总和。通常这两种解法有相同的开销，因此，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>G</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup></mrow><annotation encoding="application/x-tex">G&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">G</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>的最优解意味着<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span></span></span></span>的最优解，G‘的解法也就是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span></span></span></span>的解决方式。</p>
<blockquote>
<p>图4-3 一个图中的节点连接桩</p>
</blockquote>
<figure><img src="./a-technique-for-drawing-directed-graphs/figure-4-3.png" alt="Figure 4-3"></figure>
<p>用辅助图也可以方便定义&quot;节点连接桩&quot;(node ports)，或者说是边的末端对于节点的中心的水平位移。这就让如图4-3的有向图扁平化成为可能。当计算图中节点的坐标时，边的长度必须包含连接桩的移位和到节点中心的距离。给出一条边<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>e</mi><mo>=</mo><mo>(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">e=(u,v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">e</span><span class="mrel">=</span><span class="mopen">(</span><span class="mord mathit">u</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">\Delta u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">Δ</span><span class="mord mathit">u</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">\Delta v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">Δ</span><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span>分别是水平方向上边的末端到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">u</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span>的中心的距离。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi mathvariant="normal">Δ</mi></mrow><annotation encoding="application/x-tex">A\Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span><span class="mord mathrm">Δ</span></span></span></span>代表了连接桩在顶点中心的左侧。不失通用性的，假设<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Δ</mi><mi>u</mi><mo>≤</mo><mi mathvariant="normal">Δ</mi><mi>v</mi></mrow><annotation encoding="application/x-tex">\Delta u \leq \Delta v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">Δ</span><span class="mord mathit">u</span><span class="mrel">≤</span><span class="mord mathrm">Δ</span><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span>,让<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mi>e</mi></msub><mo>=</mo><mi mathvariant="normal">Δ</mi><mi>v</mi><mo>−</mo><mi mathvariant="normal">Δ</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">d_e= \Delta v - \Delta u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">e</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mrel">=</span><span class="mord mathrm">Δ</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mbin">−</span><span class="mord mathrm">Δ</span><span class="mord mathit">u</span></span></span></span>。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">d_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">e</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>是一个常量，因为它完全取决于节点的连接桩，而不是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">u</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span></span>的分配。我们现在可以解决相同的优化问题了，但是边的开销取决于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Ω</mi><mo>(</mo><mi>e</mi><mo>)</mo><mi>ω</mi><mo>(</mo><mi>e</mi><mo>)</mo><mrow><mo fence="true">∣</mo><msub><mi>x</mi><mi>v</mi></msub><mo>−</mo><msub><mi>x</mi><mi>u</mi></msub><mo>+</mo><msub><mi>d</mi><mi>e</mi></msub><mo fence="true">∣</mo></mrow></mrow><annotation encoding="application/x-tex">\Omega(e)\omega(e)\left | x_v -x_u+d_e\right|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">Ω</span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mclose">)</span><span class="mord mathit" style="margin-right:0.03588em;">ω</span><span class="mopen">(</span><span class="mord mathit">e</span><span class="mclose">)</span><span class="minner textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">∣</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">e</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">∣</span></span></span></span></span>。在辅助图中，我们设<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>δ</mi><mo>(</mo><msub><mi>e</mi><mi>u</mi></msub><mo>)</mo><mo>=</mo><msub><mi>d</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">\delta(e_u)=d_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">e</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>δ</mi><mo>(</mo><msub><mi>e</mi><mi>v</mi></msub><mo>)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\delta(e_v)=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">δ</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span>。上述的问题可以扩展到<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span></span></span></span>中的任何定位可以与<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>G</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup></mrow><annotation encoding="application/x-tex">G&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">G</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>的层级分配问题相统一，任何<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>G</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup></mrow><annotation encoding="application/x-tex">G&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">G</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>的最优的层级分配会催生一个<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span></span></span></span>的有效定位。上面两个例子都说明了有：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mo>(</mo><msub><mi>e</mi><mi>u</mi></msub><mo>)</mo><mo>+</mo><mi>l</mi><mo>(</mo><msub><mi>e</mi><mi>v</mi></msub><mo>)</mo><mo>=</mo><mrow><mo fence="true">∣</mo><msub><mi>x</mi><mi>v</mi></msub><mo>−</mo><msub><mi>x</mi><mi>u</mi></msub><mo>+</mo><msub><mi>d</mi><mi>e</mi></msub><mo fence="true">∣</mo></mrow><mo>+</mo><msub><mi>d</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">l(e_u)+l(e_v)=\left| x_v -x_u + d_e \right| + d_e
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord"><span class="mord mathit">e</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="minner displaystyle textstyle uncramped"><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">∣</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">−</span><span class="mord"><span class="mord mathit">x</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">e</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="style-wrap reset-textstyle textstyle uncramped" style="top:0em;">∣</span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">e</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span></span></p>
<p>对于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span></span></span></span>中所有的边<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>u</mi><mo separator="true">,</mo><mi>v</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">(u, v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">u</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mclose">)</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.01968em;">l</span></span></span></span>代表了<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>G</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup></mrow><annotation encoding="application/x-tex">G&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">G</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>层级分配中的长度度量函数。这个等式说明<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>G</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup></mrow><annotation encoding="application/x-tex">G&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">G</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>问题的最少开销总是因为常量<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mo>∑</mo><mrow><mi>e</mi><mi>m</mi><mi>e</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>r</mi><mi>E</mi></mrow></msub><msub><mi>d</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">\sum_{ememberE} d_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.0500099999999999em;vertical-align:-0.30001em;"></span><span class="base textstyle uncramped"><span class="mop"><span class="op-symbol small-op mop" style="top:-0.0000050000000000050004em;">∑</span><span class="vlist"><span style="top:0.30001em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathit">e</span><span class="mord mathit">m</span><span class="mord mathit">e</span><span class="mord mathit">m</span><span class="mord mathit">b</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.05764em;">E</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span><span class="mord"><span class="mord mathit">d</span><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">e</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>而不同。因此，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>G</mi><mrow><mi mathvariant="normal">′</mi></mrow></msup></mrow><annotation encoding="application/x-tex">G&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">G</span><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathrm">′</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">​</span></span>​</span></span></span></span></span></span>的最小分配就相当于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span></span></span></span>的最小分配。图4-4的左半边举例说明了在辅助图中连接桩位移如何转换为边的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>δ</mi></mrow><annotation encoding="application/x-tex">\delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">δ</span></span></span></span>$值。右半边展示了原本的边的解决方式。</p>
<blockquote>
<p>图4-4</p>
</blockquote>
<figure><img src="./a-technique-for-drawing-directed-graphs/figure-4-4.png" alt="Figure 4-4"></figure>
<h3>4.3 实现细节重审</h3>
<h2>5. 画边</h2>
<h3>5.1 确定区域</h3>
<h4>5.1.1 不同层级间的边</h4>
<h4>5.1.2 同层级的边</h4>
<h4>5.1.3 自连边</h4>
<h3>5.2 计算样条</h3>
<h3>5.3 边标签</h3>
<h2>6. 总结</h2>
<h2>7. 致谢</h2>
<h2>联系方式</h2>
<p>如果发现翻译问题，欢迎提出<a href="https://github.com/leungwensen/blog/issues/new">issue</a>或者<a href="https://github.com/leungwensen/blog/pulls">pull request</a>。也可以联系译者<a href="mailto:leungwensen@gmail.com">绝云</a>和<a href="https://github.com/elaine1234">青湳</a></p>
<h2>索引</h2>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>Gansner, E. R., S. C. North and K.-P. Vo, ‘‘DAG - A Program that Draws Directed Graphs,’’ Software - Practice and Experience 17(1), 1988, pp. 1047-1062. <a href="#fnref1" class="footnote-backref">↩︎</a> <a href="#fnref1:1" class="footnote-backref">↩︎</a> <a href="#fnref1:2" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn2" class="footnote-item"><p>Eades, P. and Roberto Tamassia, ‘‘Algorithms for Automatic Graph Drawing: An Annotated Bibliography,’’ Technical Report CS-89-09 (Revised Version), Brown University, Department of Computer Science, Providence RI, October 1989. <a href="#fnref2" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn3" class="footnote-item"><p>Warfield, John, ‘‘Crossing Theory and Hierarchy Mapping,’’ IEEE Transactions on Systems, Man, and Cybernetics SMC-7(7), July, 1977, pp. 505-523. <a href="#fnref3" class="footnote-backref">↩︎</a> <a href="#fnref3:1" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn4" class="footnote-item"><p>Carpano, M., ‘‘Automatic display of hierarchized graphs for computer aided decision analysis,’’ IEEE Transactions on Software Engineering SE-12(4), 1980, pp. 538-546. <a href="#fnref4" class="footnote-backref">↩︎</a> <a href="#fnref4:1" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn5" class="footnote-item"><p>Sugiyama, K., S. Tagawa and M. Toda, ‘‘Methods for Visual Understanding of Hierarchical System Structures,’’ IEEE Transactions on Systems, Man, and Cybernetics SMC-11(2), February, 1981, pp. 109-125. <a href="#fnref5" class="footnote-backref">↩︎</a> <a href="#fnref5:1" class="footnote-backref">↩︎</a> <a href="#fnref5:2" class="footnote-backref">↩︎</a> <a href="#fnref5:3" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn6" class="footnote-item"><p>Di Battista, G., and R. Tamassia, ‘‘Algorithms for Plane Representations of Acyclic Digraphs,’’ eoretical Computer Science 61, 1988, pp. 175–198. <a href="#fnref6" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn7" class="footnote-item"><p>Koutsofios, E., and S. North, ‘‘Drawing graphs with dot,’’ technical report (available from the authors), AT&amp;T Bell Laboratories, Murray Hill NJ, 1992. <a href="#fnref7" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn8" class="footnote-item"><p>Rowe, L. A., M. Davis, E. Messinger, C. Meyer, C. Spirakis, and A. Tuan, ‘‘A Browser for Directed Graphs,’’ Software - Practice and Experience 17(1), January, 1987, pp. 61-76. <a href="#fnref8" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn9" class="footnote-item"><p>Aho, A., J. Hopcroft, and J. Ullman, The Design and Analysis of Computer Algorithms, Addison-Wesley, Reading, Massachusetts, 1974. <a href="#fnref9" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn10" class="footnote-item"><p>Eades, P., B. McKay and N. Wormald, ‘‘On an Edge Crossing Problem,’’ Proc. 9th Australian mputer Science Conf., 1986, pp. 327-334. <a href="#fnref10" class="footnote-backref">↩︎</a> <a href="#fnref10:1" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn11" class="footnote-item"><p>Garey, Michael R. and David S. Johnson, Computers and Intractability, W. H. Freeman, San Francisco, 1979. <a href="#fnref11" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn12" class="footnote-item"><p>Robbins, G., ‘‘The ISI grapher, a portable tool for diplaying graphs pictorially,’’ Symboliikka ’87, Helsinki, Finland, also Technical Report IST/RS-87-196, Information Sciences Institute, Marina Del Rey, CA. <a href="#fnref12" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn13" class="footnote-item"><p>Goldberg, A. V. and R. E. Tarjan, ‘‘Finding minimum-cost circulations by successive approximation,’’ Mathematics of Operations Research, 15(3), 1990, pp. 430-466. <a href="#fnref13" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn14" class="footnote-item"><p>Gansner, E. R., S. C. North and K.-P. Vo, ‘‘On the Rank Assignment Problem,’’ to be submitted. <a href="#fnref14" class="footnote-backref">↩︎</a> <a href="#fnref14:1" class="footnote-backref">↩︎</a> <a href="#fnref14:2" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn15" class="footnote-item"><p>Chvatal, V., Linear Programming, W. H. Freeman, New York, 1983. <a href="#fnref15" class="footnote-backref">↩︎</a> <a href="#fnref15:1" class="footnote-backref">↩︎</a> <a href="#fnref15:2" class="footnote-backref">↩︎</a> <a href="#fnref15:3" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn16" class="footnote-item"><p>Cunningham, W. H., ‘‘A network simplex method,’’ Mathematical Programming 11, 1976, pp. 5-116. <a href="#fnref16" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn17" class="footnote-item"><p>Eades, P. and N. Wormald, ‘‘The Median Heuristic for Drawing 2-Layers Networks,’’ Technical Report 69, Dept. of Computer Science, Univ. of Queensland, 1986. <a href="#fnref17" class="footnote-backref">↩︎</a> <a href="#fnref17:1" class="footnote-backref">↩︎</a></p>
</li>
</ol>
</section>
</div>
</article>
<div id="loading">
  <div class="sk-double-bounce">
    <div class="sk-child sk-double-bounce1"></div>
    <div class="sk-child sk-double-bounce2"></div>
  </div>
</div>

<script src="https://leungwensen.github.io/zfinder/dist/lib/jquery-3.1.0.min.js"></script>
<script src="https://leungwensen.github.io/zfinder/dist/lib/screenfull-3.0.0.min.js"></script>
<script src="https://leungwensen.github.io/zfinder/dist/zfinder/markdown-previewer.js"></script>
</body>
</html>
